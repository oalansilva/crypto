2026-01-07 00:50:24,332 - root - INFO - Running backtest: BTC/USDT 4h from 2017-08-17 to 2026-01-07
2026-01-07 00:50:24,349 - src.data.incremental_loader - INFO - Local cache found for BTC/USDT 4h: data/storage\binance\BTC_USDT_4h.parquet
2026-01-07 00:50:24,367 - src.data.incremental_loader - INFO - Local data covers request. No network fetch needed.
2026-01-07 00:50:24,482 - app.strategies.dynamic_strategy - INFO - Processed crossover entry for RSI_14 > 30.0: 279 signals
2026-01-07 00:50:24,487 - app.strategies.dynamic_strategy - INFO - Processed crossunder exit for RSI_14 < 70.0: 339 signals
2026-01-07 00:50:24,513 - app.strategies.dynamic_strategy - INFO - Processed crossover entry for RSI_14 > 30.0: 279 signals
2026-01-07 00:50:24,522 - app.strategies.dynamic_strategy - INFO - Processed crossunder exit for RSI_14 < 70.0: 339 signals
2026-01-07 00:50:25,377 - root - INFO - DEBUG: Test 19 (stop_loss=0.095) -> Return: 0.2618597165255351, Equity: 12618.59716525535, PnL: 2618.597165255351
2026-01-07 00:50:26,663 - root - INFO - Running backtest: BTC/USDT 4h from 2017-08-17 to 2026-01-07
2026-01-07 00:50:26,677 - src.data.incremental_loader - INFO - Local cache found for BTC/USDT 4h: data/storage\binance\BTC_USDT_4h.parquet
2026-01-07 00:50:26,692 - src.data.incremental_loader - INFO - Local data covers request. No network fetch needed.
2026-01-07 00:50:26,788 - app.strategies.dynamic_strategy - INFO - Processed crossover entry for RSI_14 > 30.0: 279 signals
2026-01-07 00:50:26,792 - app.strategies.dynamic_strategy - INFO - Processed crossunder exit for RSI_14 < 70.0: 339 signals
2026-01-07 00:50:26,809 - app.strategies.dynamic_strategy - INFO - Processed crossover entry for RSI_14 > 30.0: 279 signals
2026-01-07 00:50:26,813 - app.strategies.dynamic_strategy - INFO - Processed crossunder exit for RSI_14 < 70.0: 339 signals
2026-01-07 00:50:27,206 - root - INFO - DEBUG: Test 20 (stop_loss=0.1) -> Return: 0.3635752565621442, Equity: 13635.752565621442, PnL: 3635.752565621442
2026-01-07 00:50:28,218 - root - INFO - Running backtest: BTC/USDT 4h from 2017-08-17 to 2026-01-07
2026-01-07 00:50:28,231 - src.data.incremental_loader - INFO - Local cache found for BTC/USDT 4h: data/storage\binance\BTC_USDT_4h.parquet
2026-01-07 00:50:28,246 - src.data.incremental_loader - INFO - Local data covers request. No network fetch needed.
2026-01-07 00:50:28,358 - app.strategies.dynamic_strategy - INFO - Processed crossover entry for RSI_14 > 30.0: 279 signals
2026-01-07 00:50:28,363 - app.strategies.dynamic_strategy - INFO - Processed crossunder exit for RSI_14 < 70.0: 339 signals
2026-01-07 00:50:28,385 - app.strategies.dynamic_strategy - INFO - Processed crossover entry for RSI_14 > 30.0: 279 signals
2026-01-07 00:50:28,393 - app.strategies.dynamic_strategy - INFO - Processed crossunder exit for RSI_14 < 70.0: 339 signals
2026-01-07 00:50:29,159 - root - INFO - DEBUG: Test 21 (stop_loss=0.105) -> Return: 0.16352019497181028, Equity: 11635.201949718103, PnL: 1635.2019497181027
2026-01-07 00:50:29,908 - root - INFO - Running backtest: BTC/USDT 4h from 2017-08-17 to 2026-01-07
2026-01-07 00:50:29,919 - src.data.incremental_loader - INFO - Local cache found for BTC/USDT 4h: data/storage\binance\BTC_USDT_4h.parquet
2026-01-07 00:50:29,935 - src.data.incremental_loader - INFO - Local data covers request. No network fetch needed.
2026-01-07 00:50:30,035 - app.strategies.dynamic_strategy - INFO - Processed crossover entry for RSI_14 > 30.0: 279 signals
2026-01-07 00:50:30,044 - app.strategies.dynamic_strategy - INFO - Processed crossunder exit for RSI_14 < 70.0: 339 signals
2026-01-07 00:50:30,063 - app.strategies.dynamic_strategy - INFO - Processed crossover entry for RSI_14 > 30.0: 279 signals
2026-01-07 00:50:30,067 - app.strategies.dynamic_strategy - INFO - Processed crossunder exit for RSI_14 < 70.0: 339 signals
2026-01-07 00:50:30,582 - root - INFO - DEBUG: Test 22 (stop_loss=0.11) -> Return: 0.18137993157355614, Equity: 11813.799315735561, PnL: 1813.7993157355613
2026-01-07 00:50:31,797 - root - INFO - Running backtest: BTC/USDT 4h from 2017-08-17 to 2026-01-07
2026-01-07 00:50:31,812 - src.data.incremental_loader - INFO - Local cache found for BTC/USDT 4h: data/storage\binance\BTC_USDT_4h.parquet
2026-01-07 00:50:31,833 - src.data.incremental_loader - INFO - Local data covers request. No network fetch needed.
2026-01-07 00:50:31,956 - app.strategies.dynamic_strategy - INFO - Processed crossover entry for RSI_14 > 30.0: 279 signals
2026-01-07 00:50:31,961 - app.strategies.dynamic_strategy - INFO - Processed crossunder exit for RSI_14 < 70.0: 339 signals
2026-01-07 00:50:31,984 - app.strategies.dynamic_strategy - INFO - Processed crossover entry for RSI_14 > 30.0: 279 signals
2026-01-07 00:50:31,991 - app.strategies.dynamic_strategy - INFO - Processed crossunder exit for RSI_14 < 70.0: 339 signals
2026-01-07 00:50:32,685 - root - INFO - DEBUG: Test 23 (stop_loss=0.115) -> Return: 0.05553555042791468, Equity: 10555.355504279147, PnL: 555.3555042791468
2026-01-07 00:50:34,326 - root - INFO - Running backtest: BTC/USDT 4h from 2017-08-17 to 2026-01-07
2026-01-07 00:50:34,337 - src.data.incremental_loader - INFO - Local cache found for BTC/USDT 4h: data/storage\binance\BTC_USDT_4h.parquet
2026-01-07 00:50:34,351 - src.data.incremental_loader - INFO - Local data covers request. No network fetch needed.
2026-01-07 00:50:34,442 - app.strategies.dynamic_strategy - INFO - Processed crossover entry for RSI_14 > 30.0: 279 signals
2026-01-07 00:50:34,446 - app.strategies.dynamic_strategy - INFO - Processed crossunder exit for RSI_14 < 70.0: 339 signals
2026-01-07 00:50:34,459 - app.strategies.dynamic_strategy - INFO - Processed crossover entry for RSI_14 > 30.0: 279 signals
2026-01-07 00:50:34,462 - app.strategies.dynamic_strategy - INFO - Processed crossunder exit for RSI_14 < 70.0: 339 signals
2026-01-07 00:50:35,007 - root - INFO - DEBUG: Test 24 (stop_loss=0.12) -> Return: 0.5186912943850291, Equity: 15186.912943850291, PnL: 5186.912943850291
2026-01-07 00:50:35,934 - root - INFO - Running backtest: BTC/USDT 4h from 2017-08-17 to 2026-01-07
2026-01-07 00:50:35,943 - src.data.incremental_loader - INFO - Local cache found for BTC/USDT 4h: data/storage\binance\BTC_USDT_4h.parquet
2026-01-07 00:50:35,956 - src.data.incremental_loader - INFO - Local data covers request. No network fetch needed.
2026-01-07 00:50:36,046 - app.strategies.dynamic_strategy - INFO - Processed crossover entry for RSI_14 > 30.0: 279 signals
2026-01-07 00:50:36,051 - app.strategies.dynamic_strategy - INFO - Processed crossunder exit for RSI_14 < 70.0: 339 signals
2026-01-07 00:50:36,066 - app.strategies.dynamic_strategy - INFO - Processed crossover entry for RSI_14 > 30.0: 279 signals
2026-01-07 00:50:36,070 - app.strategies.dynamic_strategy - INFO - Processed crossunder exit for RSI_14 < 70.0: 339 signals
2026-01-07 00:50:36,457 - root - INFO - DEBUG: Test 25 (stop_loss=0.125) -> Return: 0.24619478268642087, Equity: 12461.947826864209, PnL: 2461.9478268642088
2026-01-07 00:50:37,413 - root - INFO - Running backtest: BTC/USDT 4h from 2017-08-17 to 2026-01-07
2026-01-07 00:50:37,422 - src.data.incremental_loader - INFO - Local cache found for BTC/USDT 4h: data/storage\binance\BTC_USDT_4h.parquet
2026-01-07 00:50:37,434 - src.data.incremental_loader - INFO - Local data covers request. No network fetch needed.
2026-01-07 00:50:37,516 - app.strategies.dynamic_strategy - INFO - Processed crossover entry for RSI_14 > 30.0: 279 signals
2026-01-07 00:50:37,520 - app.strategies.dynamic_strategy - INFO - Processed crossunder exit for RSI_14 < 70.0: 339 signals
2026-01-07 00:50:37,536 - app.strategies.dynamic_strategy - INFO - Processed crossover entry for RSI_14 > 30.0: 279 signals
2026-01-07 00:50:37,540 - app.strategies.dynamic_strategy - INFO - Processed crossunder exit for RSI_14 < 70.0: 339 signals
2026-01-07 00:50:38,022 - root - INFO - DEBUG: Test 26 (stop_loss=0.13) -> Return: 0.29290180015608785, Equity: 12929.018001560878, PnL: 2929.0180015608785
 Stage 1 complete: stop_loss = 0.12
 DEBUG: stage_result keys: dict_keys(['stage_num', 'stage_name', 'parameter', 'results', 'best_value', 'best_result'])
 DEBUG: stage['parameter']: stop_loss
 DEBUG: Number of results: 26
 DEBUG: Result 0 keys: ['stop_loss', 'metrics', 'trades', 'test_num', 'total_tests']
 DEBUG: Result 0 has parameter 'stop_loss': True
 DEBUG: Extracted param_value for 'stop_loss': 0.005 (type: float)
 DEBUG: Result Metrics: {'total_return_pct': np.float64(-0.5797583486361507), 'total_pnl_pct': np.float64(-0.5797583486361507), 'total_pnl': np.float64(-5797.583486361507), 'max_drawdown_pct': np.float64(-0.65016392226295), 'max_drawdown': np.float64(-0.65016392226295), 'cagr': np.float64(-0.09879498063176595), 'num_trades': 278, 'total_trades': 278, 'win_rate': 0.03597122302158273, 'profit_factor': np.float64(0.595676247555882), 'avg_trade_return': np.float64(-20.85461685741543), 'sharpe': np.float64(-0.5855043506176958), 'sharpe_ratio': np.float64(-0.5855043506176958), 'final_equity': np.float64(4202.416513638493), 'duration_days': 3044, 'monthly_return_avg': np.float64(-0.007658868762337081), 'avg_drawdown': np.float64(0.399110728329301), 'max_dd_duration_days': 2918, 'recovery_factor': np.float64(0.8917110420680576), 'sortino_ratio': np.float64(-11.970178951892326), 'calmar_ratio': np.float64(-0.1519539569158217), 'expectancy': np.float64(-20.85461685741543), 'max_consecutive_wins': 1, 'max_consecutive_losses': 79, 'trade_concentration_top_10_pct': np.float64(1.0), 'benchmark': {'return_pct': np.float64(20.284536286290315), 'cagr': np.float64(0.43984068388293496), 'final_value': np.float64(212845.36286290316)}, 'alpha': np.float64(-0.5386356645147009), 'avg_atr': 623.2955836989505, 'avg_adx': 28.24622105493285, 'regime_performance': {'Unknown': {'count': 4, 'wins': 0, 'losses': 4, 'pnl': np.float64(-293.10895948714153), 'win_rate': 0.0}, 'Bear': {'count': 238, 'wins': 9, 'losses': 229, 'pnl': np.float64(-4079.121727408156), 'win_rate': 3.7815126050420167}, 'Bull': {'count': 36, 'wins': 1, 'losses': 35, 'pnl': np.float64(-1425.3527994661933), 'win_rate': 2.7777777777777777}}, 'criteria_result': {'status': 'NO-GO', 'reasons': ['Sharpe Ratio muito baixo: -0.59 < 0.8', 'CAGR não supera Buy & Hold: -9.9% ≤ 44.0%', 'Calmar Ratio baixo: -0.15 < 1.0', 'Profit Factor baixo: 0.60 < 1.3', 'Expectancy negativa ou zero: $-20.85'], 'warnings': []}, 'strategy': 'rsi', 'timeframe': '4h'}
 DEBUG: full_params after assignment: {'length': 15, 'overbought': 70, 'oversold': 30, 'timeframe': '4h', 'stop_loss': 0.005}
 DEBUG: result_data has 278 trades
 DEBUG: First trade sample: {'entry_time': '2017-09-04T16:00:00.000000000', 'exit_time': '2017-09-04T20:00:00.000000000', 'side': 'long', 'reason': 'SL', 'entry_price': np.float64(4205.771835), 'exit_price': np.float64(4182.650604337086), 'size': np.float64(2.3515564510193863), 'pnl_gross': np.float64(-54.37087912088066), 'pnl': np.float64(-74.09672802197956), 'pnl_pct': np.float64(-0.005497500000000155), 'commission': np.float64(19.7258489010989), 'initial_capital': 10000, 'final_capital': np.float64(9925.90327197802)}
 DEBUG: Result 1 keys: ['stop_loss', 'metrics', 'trades', 'test_num', 'total_tests']
 DEBUG: Result 1 has parameter 'stop_loss': True
 DEBUG: Extracted param_value for 'stop_loss': 0.01 (type: float)
 DEBUG: Result Metrics: {'total_return_pct': np.float64(-0.5607408439193455), 'total_pnl_pct': np.float64(-0.5607408439193455), 'total_pnl': np.float64(-5607.408439193456), 'max_drawdown_pct': np.float64(-0.7211440202176564), 'max_drawdown': np.float64(-0.7211440202176564), 'cagr': np.float64(-0.0934703117320258), 'num_trades': 266, 'total_trades': 266, 'win_rate': 0.08646616541353383, 'profit_factor': np.float64(0.6906786630500017), 'avg_trade_return': np.float64(-21.08048285411079), 'sharpe': np.float64(-0.5392460836408014), 'sharpe_ratio': np.float64(-0.5392460836408014), 'final_equity': np.float64(4392.591560806544), 'duration_days': 3062, 'monthly_return_avg': np.float64(-0.006537886170065896), 'avg_drawdown': np.float64(0.490256975032486), 'max_dd_duration_days': 2936, 'recovery_factor': np.float64(0.7775712315413807), 'sortino_ratio': np.float64(-5.133854882688999), 'calmar_ratio': np.float64(-0.1296139316302096), 'expectancy': np.float64(-21.080482854110784), 'max_consecutive_wins': 2, 'max_consecutive_losses': 76, 'trade_concentration_top_10_pct': np.float64(0.6838180291299399), 'benchmark': {'return_pct': np.float64(20.284536286290315), 'cagr': np.float64(0.43984068388293496), 'final_value': np.float64(212845.36286290316)}, 'alpha': np.float64(-0.5333109956149608), 'avg_atr': 623.2955836989505, 'avg_adx': 28.24622105493285, 'regime_performance': {'Unknown': {'count': 4, 'wins': 0, 'losses': 4, 'pnl': np.float64(-484.82020224361474), 'win_rate': 0.0}, 'Bear': {'count': 227, 'wins': 21, 'losses': 206, 'pnl': np.float64(-3437.4144492665914), 'win_rate': 9.251101321585903}, 'Bull': {'count': 35, 'wins': 2, 'losses': 33, 'pnl': np.float64(-1685.1737876832663), 'win_rate': 5.714285714285714}}, 'criteria_result': {'status': 'NO-GO', 'reasons': ['Sharpe Ratio muito baixo: -0.54 < 0.8', 'CAGR não supera Buy & Hold: -9.3% ≤ 44.0%', 'Calmar Ratio baixo: -0.13 < 1.0', 'Profit Factor baixo: 0.69 < 1.3', 'Expectancy negativa ou zero: $-21.08'], 'warnings': []}, 'strategy': 'rsi', 'timeframe': '4h'}
 DEBUG: full_params after assignment: {'length': 15, 'overbought': 70, 'oversold': 30, 'timeframe': '4h', 'stop_loss': 0.01}
 DEBUG: result_data has 266 trades
 DEBUG: First trade sample: {'entry_time': '2017-09-04T16:00:00.000000000', 'exit_time': '2017-09-04T20:00:00.000000000', 'side': 'long', 'reason': 'SL', 'entry_price': np.float64(4205.771835), 'exit_price': np.float64(4161.6322595916745), 'size': np.float64(2.3515564510193863), 'pnl_gross': np.float64(-103.79670329670348), 'pnl': np.float64(-123.47312637362657), 'pnl_pct': np.float64(-0.010495000000000018), 'commission': np.float64(19.67642307692308), 'initial_capital': 10000, 'final_capital': np.float64(9876.526873626375)}
 DEBUG: Result 2 keys: ['stop_loss', 'metrics', 'trades', 'test_num', 'total_tests']
 DEBUG: Result 2 has parameter 'stop_loss': True
 DEBUG: Extracted param_value for 'stop_loss': 0.015 (type: float)
 DEBUG: Result Metrics: {'total_return_pct': np.float64(-0.35758819841330425), 'total_pnl_pct': np.float64(-0.35758819841330425), 'total_pnl': np.float64(-3575.8819841330424), 'max_drawdown_pct': np.float64(-0.6674028306909142), 'max_drawdown': np.float64(-0.6674028306909142), 'cagr': np.float64(-0.05141756902432282), 'num_trades': 258, 'total_trades': 258, 'win_rate': 0.13565891472868216, 'profit_factor': np.float64(0.8453487665084588), 'avg_trade_return': np.float64(-13.86000769043808), 'sharpe': np.float64(-0.28694813702104077), 'sharpe_ratio': np.float64(-0.28694813702104077), 'final_equity': np.float64(6424.118015866958), 'duration_days': 3062, 'monthly_return_avg': np.float64(-0.0017234353886852768), 'avg_drawdown': np.float64(0.48063140093210016), 'max_dd_duration_days': 2936, 'recovery_factor': np.float64(0.53579065291515), 'sortino_ratio': np.float64(-0.8804963184735937), 'calmar_ratio': np.float64(-0.07704128100729495), 'expectancy': np.float64(-13.860007690438081), 'max_consecutive_wins': 2, 'max_consecutive_losses': 35, 'trade_concentration_top_10_pct': np.float64(0.5059365034467695), 'benchmark': {'return_pct': np.float64(20.284536286290315), 'cagr': np.float64(0.43984068388293496), 'final_value': np.float64(212845.36286290316)}, 'alpha': np.float64(-0.4912582529072578), 'avg_atr': 623.2955836989505, 'avg_adx': 28.24622105493285, 'regime_performance': {'Unknown': {'count': 4, 'wins': 0, 'losses': 4, 'pnl': np.float64(-673.6776000708053), 'win_rate': 0.0}, 'Bear': {'count': 222, 'wins': 31, 'losses': 191, 'pnl': np.float64(-1215.7451181752597), 'win_rate': 13.963963963963963}, 'Bull': {'count': 32, 'wins': 4, 'losses': 28, 'pnl': np.float64(-1686.4592658869594), 'win_rate': 12.5}}, 'criteria_result': {'status': 'NO-GO', 'reasons': ['Sharpe Ratio muito baixo: -0.29 < 0.8', 'CAGR não supera Buy & Hold: -5.1% ≤ 44.0%', 'Calmar Ratio baixo: -0.08 < 1.0', 'Profit Factor baixo: 0.85 < 1.3', 'Expectancy negativa ou zero: $-13.86'], 'warnings': []}, 'strategy': 'rsi', 'timeframe': '4h'}
 DEBUG: full_params after assignment: {'length': 15, 'overbought': 70, 'oversold': 30, 'timeframe': '4h', 'stop_loss': 0.015}
 DEBUG: result_data has 258 trades
 DEBUG: First trade sample: {'entry_time': '2017-09-04T16:00:00.000000000', 'exit_time': '2017-09-04T20:00:00.000000000', 'side': 'long', 'reason': 'SL', 'entry_price': np.float64(4205.771835), 'exit_price': np.float64(4140.613914846262), 'size': np.float64(2.3515564510193863), 'pnl_gross': np.float64(-153.22252747252844), 'pnl': np.float64(-172.8495247252757), 'pnl_pct': np.float64(-0.015492500000000098), 'commission': np.float64(19.626997252747252), 'initial_capital': 10000, 'final_capital': np.float64(9827.150475274726)}
 DEBUG: Result 3 keys: ['stop_loss', 'metrics', 'trades', 'test_num', 'total_tests']
 DEBUG: Result 3 has parameter 'stop_loss': True
 DEBUG: Extracted param_value for 'stop_loss': 0.02 (type: float)
 DEBUG: Result Metrics: {'total_return_pct': np.float64(-0.06565496370496567), 'total_pnl_pct': np.float64(-0.06565496370496567), 'total_pnl': np.float64(-656.5496370496567), 'max_drawdown_pct': np.float64(-0.6473904853115546), 'max_drawdown': np.float64(-0.6473904853115546), 'cagr': np.float64(-0.00806784759179724), 'num_trades': 253, 'total_trades': 253, 'win_rate': 0.17786561264822134, 'profit_factor': np.float64(0.9826428138308586), 'avg_trade_return': np.float64(-2.595057853951212), 'sharpe': np.float64(-0.029430346187226723), 'sharpe_ratio': np.float64(-0.029430346187226723), 'final_equity': np.float64(9343.450362950343), 'duration_days': 3062, 'monthly_return_avg': np.float64(0.003154314212816163), 'avg_drawdown': np.float64(0.4316020553681258), 'max_dd_duration_days': 2859, 'recovery_factor': np.float64(0.10141478009731555), 'sortino_ratio': np.float64(1.3601532711729682), 'calmar_ratio': np.float64(-0.012462104054424916), 'expectancy': np.float64(-2.5950578539512037), 'max_consecutive_wins': 3, 'max_consecutive_losses': 29, 'trade_concentration_top_10_pct': np.float64(0.4683486157310616), 'benchmark': {'return_pct': np.float64(20.284536286290315), 'cagr': np.float64(0.43984068388293496), 'final_value': np.float64(212845.36286290316)}, 'alpha': np.float64(-0.4479085314747322), 'avg_atr': 623.2955836989505, 'avg_adx': 28.24622105493285, 'regime_performance': {'Unknown': {'count': 4, 'wins': 0, 'losses': 4, 'pnl': np.float64(-859.7096163675069), 'win_rate': 0.0}, 'Bear': {'count': 217, 'wins': 40, 'losses': 177, 'pnl': np.float64(2543.5384049547765), 'win_rate': 18.433179723502306}, 'Bull': {'count': 32, 'wins': 5, 'losses': 27, 'pnl': np.float64(-2340.378425636926), 'win_rate': 15.625}}, 'criteria_result': {'status': 'NO-GO', 'reasons': ['Sharpe Ratio muito baixo: -0.03 < 0.8', 'CAGR não supera Buy & Hold: -0.8% ≤ 44.0%', 'Calmar Ratio baixo: -0.01 < 1.0', 'Profit Factor baixo: 0.98 < 1.3', 'Expectancy negativa ou zero: $-2.60'], 'warnings': []}, 'strategy': 'rsi', 'timeframe': '4h'}
 DEBUG: full_params after assignment: {'length': 15, 'overbought': 70, 'oversold': 30, 'timeframe': '4h', 'stop_loss': 0.02}
 DEBUG: result_data has 253 trades
 DEBUG: First trade sample: {'entry_time': '2017-09-04T16:00:00.000000000', 'exit_time': '2017-09-04T20:00:00.000000000', 'side': 'long', 'reason': 'SL', 'entry_price': np.float64(4205.771835), 'exit_price': np.float64(4119.59557010085), 'size': np.float64(2.3515564510193863), 'pnl_gross': np.float64(-202.64835164835128), 'pnl': np.float64(-222.2259230769227), 'pnl_pct': np.float64(-0.02048999999999996), 'commission': np.float64(19.57757142857143), 'initial_capital': 10000, 'final_capital': np.float64(9777.774076923077)}
 DEBUG: Result 4 keys: ['stop_loss', 'metrics', 'trades', 'test_num', 'total_tests']
 DEBUG: Result 4 has parameter 'stop_loss': True
 DEBUG: Extracted param_value for 'stop_loss': 0.025 (type: float)
 DEBUG: Result Metrics: {'total_return_pct': np.float64(-0.31424818788817466), 'total_pnl_pct': np.float64(-0.31424818788817466), 'total_pnl': np.float64(-3142.4818788817465), 'max_drawdown_pct': np.float64(-0.7473330959876193), 'max_drawdown': np.float64(-0.7473330959876193), 'cagr': np.float64(-0.04400149716640245), 'num_trades': 246, 'total_trades': 246, 'win_rate': 0.21138211382113822, 'profit_factor': np.float64(0.9159633552517757), 'avg_trade_return': np.float64(-12.774316580820134), 'sharpe': np.float64(-0.15142618535249444), 'sharpe_ratio': np.float64(-0.15142618535249444), 'final_equity': np.float64(6857.5181211182535), 'duration_days': 3062, 'monthly_return_avg': np.float64(0.0005679290298783534), 'avg_drawdown': np.float64(0.486481449451428), 'max_dd_duration_days': 2859, 'recovery_factor': np.float64(0.4204928024402396), 'sortino_ratio': np.float64(0.2405555363864967), 'calmar_ratio': np.float64(-0.05887802561219823), 'expectancy': np.float64(-12.774316580820084), 'max_consecutive_wins': 5, 'max_consecutive_losses': 22, 'trade_concentration_top_10_pct': np.float64(0.4603850019665394), 'benchmark': {'return_pct': np.float64(20.284536286290315), 'cagr': np.float64(0.43984068388293496), 'final_value': np.float64(212845.36286290316)}, 'alpha': np.float64(-0.4838421810493374), 'avg_atr': 623.2955836989505, 'avg_adx': 28.24622105493285, 'regime_performance': {'Unknown': {'count': 4, 'wins': 0, 'losses': 4, 'pnl': np.float64(-1042.9445718769066), 'win_rate': 0.0}, 'Bear': {'count': 212, 'wins': 47, 'losses': 165, 'pnl': np.float64(858.2131703966481), 'win_rate': 22.169811320754718}, 'Bull': {'count': 30, 'wins': 5, 'losses': 25, 'pnl': np.float64(-2957.7504774014938), 'win_rate': 16.666666666666664}}, 'criteria_result': {'status': 'NO-GO', 'reasons': ['Sharpe Ratio muito baixo: -0.15 < 0.8', 'CAGR não supera Buy & Hold: -4.4% ≤ 44.0%', 'Calmar Ratio baixo: -0.06 < 1.0', 'Profit Factor baixo: 0.92 < 1.3', 'Expectancy negativa ou zero: $-12.77'], 'warnings': []}, 'strategy': 'rsi', 'timeframe': '4h'}
 DEBUG: full_params after assignment: {'length': 15, 'overbought': 70, 'oversold': 30, 'timeframe': '4h', 'stop_loss': 0.025}
 DEBUG: result_data has 246 trades
 DEBUG: First trade sample: {'entry_time': '2017-09-04T16:00:00.000000000', 'exit_time': '2017-09-04T20:00:00.000000000', 'side': 'long', 'reason': 'SL', 'entry_price': np.float64(4205.771835), 'exit_price': np.float64(4098.577225355437), 'size': np.float64(2.3515564510193863), 'pnl_gross': np.float64(-252.07417582417625), 'pnl': np.float64(-271.6023214285718), 'pnl_pct': np.float64(-0.02548750000000004), 'commission': np.float64(19.528145604395604), 'initial_capital': 10000, 'final_capital': np.float64(9728.397678571428)}
 DEBUG: Result 5 keys: ['stop_loss', 'metrics', 'trades', 'test_num', 'total_tests']
 DEBUG: Result 5 has parameter 'stop_loss': True
 DEBUG: Extracted param_value for 'stop_loss': 0.03 (type: float)
 DEBUG: Result Metrics: {'total_return_pct': np.float64(-0.42878443942437716), 'total_pnl_pct': np.float64(-0.42878443942437716), 'total_pnl': np.float64(-4287.844394243772), 'max_drawdown_pct': np.float64(-0.8072014500263893), 'max_drawdown': np.float64(-0.8072014500263893), 'cagr': np.float64(-0.06461598311882655), 'num_trades': 230, 'total_trades': 230, 'win_rate': 0.2391304347826087, 'profit_factor': np.float64(0.8766625251374595), 'avg_trade_return': np.float64(-18.642801714103417), 'sharpe': np.float64(-0.22337500685790312), 'sharpe_ratio': np.float64(-0.22337500685790312), 'final_equity': np.float64(5712.155605756228), 'duration_days': 3062, 'monthly_return_avg': np.float64(-0.0006885165580298257), 'avg_drawdown': np.float64(0.5338644664080011), 'max_dd_duration_days': 2859, 'recovery_factor': np.float64(0.5311987972895232), 'sortino_ratio': np.float64(-0.22891516406530663), 'calmar_ratio': np.float64(-0.08004938930265065), 'expectancy': np.float64(-18.642801714103427), 'max_consecutive_wins': 5, 'max_consecutive_losses': 19, 'trade_concentration_top_10_pct': np.float64(0.4588988091346117), 'benchmark': {'return_pct': np.float64(20.284536286290315), 'cagr': np.float64(0.43984068388293496), 'final_value': np.float64(212845.36286290316)}, 'alpha': np.float64(-0.5044566670017615), 'avg_atr': 623.2955836989505, 'avg_adx': 28.24622105493285, 'regime_performance': {'Unknown': {'count': 4, 'wins': 0, 'losses': 4, 'pnl': np.float64(-1223.4106446865683), 'win_rate': 0.0}, 'Bear': {'count': 199, 'wins': 50, 'losses': 149, 'pnl': np.float64(-42.987170201907134), 'win_rate': 25.125628140703515}, 'Bull': {'count': 27, 'wins': 5, 'losses': 22, 'pnl': np.float64(-3021.4465793553104), 'win_rate': 18.51851851851852}}, 'criteria_result': {'status': 'NO-GO', 'reasons': ['Sharpe Ratio muito baixo: -0.22 < 0.8', 'CAGR não supera Buy & Hold: -6.5% ≤ 44.0%', 'Calmar Ratio baixo: -0.08 < 1.0', 'Profit Factor baixo: 0.88 < 1.3', 'Expectancy negativa ou zero: $-18.64'], 'warnings': []}, 'strategy': 'rsi', 'timeframe': '4h'}
 DEBUG: full_params after assignment: {'length': 15, 'overbought': 70, 'oversold': 30, 'timeframe': '4h', 'stop_loss': 0.03}
 DEBUG: result_data has 230 trades
 DEBUG: First trade sample: {'entry_time': '2017-09-04T16:00:00.000000000', 'exit_time': '2017-09-05T00:00:00.000000000', 'side': 'long', 'reason': 'SL', 'entry_price': np.float64(4205.771835), 'exit_price': np.float64(4077.558880610025), 'size': np.float64(2.3515564510193863), 'pnl_gross': np.float64(-301.4999999999991), 'pnl': np.float64(-320.97871978021885), 'pnl_pct': np.float64(-0.030484999999999905), 'commission': np.float64(19.478719780219784), 'initial_capital': 10000, 'final_capital': np.float64(9679.021280219782)}
 DEBUG: Result 6 keys: ['stop_loss', 'metrics', 'trades', 'test_num', 'total_tests']
 DEBUG: Result 6 has parameter 'stop_loss': True
 DEBUG: Extracted param_value for 'stop_loss': 0.035 (type: float)
 DEBUG: Result Metrics: {'total_return_pct': np.float64(-0.5530304744306732), 'total_pnl_pct': np.float64(-0.5530304744306732), 'total_pnl': np.float64(-5530.304744306732), 'max_drawdown_pct': np.float64(-0.8327308652659131), 'max_drawdown': np.float64(-0.8327308652659131), 'cagr': np.float64(-0.09158671376267369), 'num_trades': 217, 'total_trades': 217, 'win_rate': 0.2626728110599078, 'profit_factor': np.float64(0.8087910325714237), 'avg_trade_return': np.float64(-25.48527531938587), 'sharpe': np.float64(-0.33453537970405683), 'sharpe_ratio': np.float64(-0.33453537970405683), 'final_equity': np.float64(4469.695255693268), 'duration_days': 3062, 'monthly_return_avg': np.float64(-0.002662653375366049), 'avg_drawdown': np.float64(0.6225071587207089), 'max_dd_duration_days': 2859, 'recovery_factor': np.float64(0.6641167002427318), 'sortino_ratio': np.float64(-0.8007078049236076), 'calmar_ratio': np.float64(-0.10998357042215268), 'expectancy': np.float64(-25.485275319385863), 'max_consecutive_wins': 8, 'max_consecutive_losses': 23, 'trade_concentration_top_10_pct': np.float64(0.4723597638463221), 'benchmark': {'return_pct': np.float64(20.284536286290315), 'cagr': np.float64(0.43984068388293496), 'final_value': np.float64(212845.36286290316)}, 'alpha': np.float64(-0.5314273976456086), 'avg_atr': 623.2955836989505, 'avg_adx': 28.24622105493285, 'regime_performance': {'Unknown': {'count': 4, 'wins': 0, 'losses': 4, 'pnl': np.float64(-1401.135870228439), 'win_rate': 0.0}, 'Bear': {'count': 186, 'wins': 52, 'losses': 134, 'pnl': np.float64(-1074.7187716612111), 'win_rate': 27.956989247311824}, 'Bull': {'count': 27, 'wins': 5, 'losses': 22, 'pnl': np.float64(-3054.450102417082), 'win_rate': 18.51851851851852}}, 'criteria_result': {'status': 'NO-GO', 'reasons': ['Sharpe Ratio muito baixo: -0.33 < 0.8', 'CAGR não supera Buy & Hold: -9.2% ≤ 44.0%', 'Calmar Ratio baixo: -0.11 < 1.0', 'Profit Factor baixo: 0.81 < 1.3', 'Expectancy negativa ou zero: $-25.49'], 'warnings': []}, 'strategy': 'rsi', 'timeframe': '4h'}
 DEBUG: full_params after assignment: {'length': 15, 'overbought': 70, 'oversold': 30, 'timeframe': '4h', 'stop_loss': 0.035}
 DEBUG: result_data has 217 trades
 DEBUG: First trade sample: {'entry_time': '2017-09-04T16:00:00.000000000', 'exit_time': '2017-09-05T00:00:00.000000000', 'side': 'long', 'reason': 'SL', 'entry_price': np.float64(4205.771835), 'exit_price': np.float64(4056.540535864612), 'size': np.float64(2.3515564510193863), 'pnl_gross': np.float64(-350.92582417582406), 'pnl': np.float64(-370.35511813186804), 'pnl_pct': np.float64(-0.035482499999999986), 'commission': np.float64(19.429293956043956), 'initial_capital': 10000, 'final_capital': np.float64(9629.644881868133)}
 DEBUG: Result 7 keys: ['stop_loss', 'metrics', 'trades', 'test_num', 'total_tests']
 DEBUG: Result 7 has parameter 'stop_loss': True
 DEBUG: Extracted param_value for 'stop_loss': 0.04 (type: float)
 DEBUG: Result Metrics: {'total_return_pct': np.float64(-0.6303429983005926), 'total_pnl_pct': np.float64(-0.6303429983005926), 'total_pnl': np.float64(-6303.429983005926), 'max_drawdown_pct': np.float64(-0.8482753123626486), 'max_drawdown': np.float64(-0.8482753123626486), 'cagr': np.float64(-0.11193451632099005), 'num_trades': 210, 'total_trades': 210, 'win_rate': 0.28095238095238095, 'profit_factor': np.float64(0.7684838406086719), 'avg_trade_return': np.float64(-30.01633325240919), 'sharpe': np.float64(-0.4030846955279553), 'sharpe_ratio': np.float64(-0.4030846955279553), 'final_equity': np.float64(3696.5700169940737), 'duration_days': 3062, 'monthly_return_avg': np.float64(-0.004031035485072997), 'avg_drawdown': np.float64(0.6577798997443848), 'max_dd_duration_days': 2859, 'recovery_factor': np.float64(0.7430877559609006), 'sortino_ratio': np.float64(-1.0561676353578353), 'calmar_ratio': np.float64(-0.1319554096290104), 'expectancy': np.float64(-30.016333252409197), 'max_consecutive_wins': 8, 'max_consecutive_losses': 23, 'trade_concentration_top_10_pct': np.float64(0.49181240062022197), 'benchmark': {'return_pct': np.float64(20.284536286290315), 'cagr': np.float64(0.43984068388293496), 'final_value': np.float64(212845.36286290316)}, 'alpha': np.float64(-0.551775200203925), 'avg_atr': 623.2955836989505, 'avg_adx': 28.24622105493285, 'regime_performance': {'Unknown': {'count': 4, 'wins': 0, 'losses': 4, 'pnl': np.float64(-1576.1481412788537), 'win_rate': 0.0}, 'Bear': {'count': 180, 'wins': 53, 'losses': 127, 'pnl': np.float64(-2505.0782476323234), 'win_rate': 29.444444444444446}, 'Bull': {'count': 26, 'wins': 6, 'losses': 20, 'pnl': np.float64(-2222.2035940947558), 'win_rate': 23.076923076923077}}, 'criteria_result': {'status': 'NO-GO', 'reasons': ['Sharpe Ratio muito baixo: -0.40 < 0.8', 'CAGR não supera Buy & Hold: -11.2% ≤ 44.0%', 'Calmar Ratio baixo: -0.13 < 1.0', 'Profit Factor baixo: 0.77 < 1.3', 'Expectancy negativa ou zero: $-30.02'], 'warnings': []}, 'strategy': 'rsi', 'timeframe': '4h'}
 DEBUG: full_params after assignment: {'length': 15, 'overbought': 70, 'oversold': 30, 'timeframe': '4h', 'stop_loss': 0.04}
 DEBUG: result_data has 210 trades
 DEBUG: First trade sample: {'entry_time': '2017-09-04T16:00:00.000000000', 'exit_time': '2017-09-05T00:00:00.000000000', 'side': 'long', 'reason': 'SL', 'entry_price': np.float64(4205.771835), 'exit_price': np.float64(4035.5221911191993), 'size': np.float64(2.3515564510193863), 'pnl_gross': np.float64(-400.35164835164903), 'pnl': np.float64(-419.73151648351717), 'pnl_pct': np.float64(-0.040480000000000065), 'commission': np.float64(19.379868131868133), 'initial_capital': 10000, 'final_capital': np.float64(9580.268483516484)}
 DEBUG: Result 8 keys: ['stop_loss', 'metrics', 'trades', 'test_num', 'total_tests']
 DEBUG: Result 8 has parameter 'stop_loss': True
 DEBUG: Extracted param_value for 'stop_loss': 0.045 (type: float)
 DEBUG: Result Metrics: {'total_return_pct': np.float64(-0.6102727857093229), 'total_pnl_pct': np.float64(-0.6102727857093229), 'total_pnl': np.float64(-6102.7278570932285), 'max_drawdown_pct': np.float64(-0.8263603547863564), 'max_drawdown': np.float64(-0.8263603547863564), 'cagr': np.float64(-0.10631599802022973), 'num_trades': 202, 'total_trades': 202, 'win_rate': 0.3069306930693069, 'profit_factor': np.float64(0.7982826359210209), 'avg_trade_return': np.float64(-30.21152404501599), 'sharpe': np.float64(-0.37191207316165653), 'sharpe_ratio': np.float64(-0.37191207316165653), 'final_equity': np.float64(3897.2721429067715), 'duration_days': 3062, 'monthly_return_avg': np.float64(-0.002911518201917446), 'avg_drawdown': np.float64(0.6141797691814185), 'max_dd_duration_days': 2859, 'recovery_factor': np.float64(0.7385068537891077), 'sortino_ratio': np.float64(-0.7717882735007338), 'calmar_ratio': np.float64(-0.12865573403229902), 'expectancy': np.float64(-30.211524045015963), 'max_consecutive_wins': 8, 'max_consecutive_losses': 15, 'trade_concentration_top_10_pct': np.float64(0.4708168934706023), 'benchmark': {'return_pct': np.float64(20.284536286290315), 'cagr': np.float64(0.43984068388293496), 'final_value': np.float64(212845.36286290316)}, 'alpha': np.float64(-0.5461566819031647), 'avg_atr': 623.2955836989505, 'avg_adx': 28.24622105493285, 'regime_performance': {'Unknown': {'count': 4, 'wins': 0, 'losses': 4, 'pnl': np.float64(-1748.4752079585264), 'win_rate': 0.0}, 'Bear': {'count': 172, 'wins': 55, 'losses': 117, 'pnl': np.float64(-2175.0493421089664), 'win_rate': 31.976744186046513}, 'Bull': {'count': 26, 'wins': 7, 'losses': 19, 'pnl': np.float64(-2179.203307025737), 'win_rate': 26.923076923076923}}, 'criteria_result': {'status': 'NO-GO', 'reasons': ['Sharpe Ratio muito baixo: -0.37 < 0.8', 'CAGR não supera Buy & Hold: -10.6% ≤ 44.0%', 'Calmar Ratio baixo: -0.13 < 1.0', 'Profit Factor baixo: 0.80 < 1.3', 'Expectancy negativa ou zero: $-30.21'], 'warnings': []}, 'strategy': 'rsi', 'timeframe': '4h'}
 DEBUG: full_params after assignment: {'length': 15, 'overbought': 70, 'oversold': 30, 'timeframe': '4h', 'stop_loss': 0.045}
 DEBUG: result_data has 202 trades
 DEBUG: First trade sample: {'entry_time': '2017-09-04T16:00:00.000000000', 'exit_time': '2017-09-05T00:00:00.000000000', 'side': 'long', 'reason': 'SL', 'entry_price': np.float64(4205.771835), 'exit_price': np.float64(4014.503846373787), 'size': np.float64(2.3515564510193863), 'pnl_gross': np.float64(-449.7774725274729), 'pnl': np.float64(-469.1079148351652), 'pnl_pct': np.float64(-0.04547750000000003), 'commission': np.float64(19.33044230769231), 'initial_capital': 10000, 'final_capital': np.float64(9530.892085164836)}
 DEBUG: Result 9 keys: ['stop_loss', 'metrics', 'trades', 'test_num', 'total_tests']
 DEBUG: Result 9 has parameter 'stop_loss': True
 DEBUG: Extracted param_value for 'stop_loss': 0.05 (type: float)
 DEBUG: Result Metrics: {'total_return_pct': np.float64(-0.5686855939918751), 'total_pnl_pct': np.float64(-0.5686855939918751), 'total_pnl': np.float64(-5686.855939918752), 'max_drawdown_pct': np.float64(-0.8308649759879196), 'max_drawdown': np.float64(-0.8308649759879196), 'cagr': np.float64(-0.09544187717124353), 'num_trades': 194, 'total_trades': 194, 'win_rate': 0.33505154639175255, 'profit_factor': np.float64(0.8070761946480138), 'avg_trade_return': np.float64(-29.31369041195232), 'sharpe': np.float64(-0.356783170026178), 'sharpe_ratio': np.float64(-0.356783170026178), 'final_equity': np.float64(4313.144060081248), 'duration_days': 3062, 'monthly_return_avg': np.float64(-0.0012713497231919219), 'avg_drawdown': np.float64(0.6157931062004428), 'max_dd_duration_days': 2859, 'recovery_factor': np.float64(0.6844500736304276), 'sortino_ratio': np.float64(-0.45430848580862987), 'calmar_ratio': np.float64(-0.11487050234336897), 'expectancy': np.float64(-29.313690411952336), 'max_consecutive_wins': 9, 'max_consecutive_losses': 15, 'trade_concentration_top_10_pct': np.float64(0.44127447369906736), 'benchmark': {'return_pct': np.float64(20.284536286290315), 'cagr': np.float64(0.43984068388293496), 'final_value': np.float64(212845.36286290316)}, 'alpha': np.float64(-0.5352825610541785), 'avg_atr': 623.2955836989505, 'avg_adx': 28.24622105493285, 'regime_performance': {'Unknown': {'count': 4, 'wins': 0, 'losses': 4, 'pnl': np.float64(-1918.1446777325573), 'win_rate': 0.0}, 'Bear': {'count': 165, 'wins': 56, 'losses': 109, 'pnl': np.float64(-2840.144162819405), 'win_rate': 33.939393939393945}, 'Bull': {'count': 25, 'wins': 9, 'losses': 16, 'pnl': np.float64(-928.5670993667886), 'win_rate': 36.0}}, 'criteria_result': {'status': 'NO-GO', 'reasons': ['Sharpe Ratio muito baixo: -0.36 < 0.8', 'CAGR não supera Buy & Hold: -9.5% ≤ 44.0%', 'Calmar Ratio baixo: -0.11 < 1.0', 'Profit Factor baixo: 0.81 < 1.3', 'Expectancy negativa ou zero: $-29.31'], 'warnings': []}, 'strategy': 'rsi', 'timeframe': '4h'}
 DEBUG: full_params after assignment: {'length': 15, 'overbought': 70, 'oversold': 30, 'timeframe': '4h', 'stop_loss': 0.05}
 DEBUG: result_data has 194 trades
 DEBUG: First trade sample: {'entry_time': '2017-09-04T16:00:00.000000000', 'exit_time': '2017-09-05T00:00:00.000000000', 'side': 'long', 'reason': 'SL', 'entry_price': np.float64(4205.771835), 'exit_price': np.float64(3993.4855016283745), 'size': np.float64(2.3515564510193863), 'pnl_gross': np.float64(-499.2032967032968), 'pnl': np.float64(-518.4843131868133), 'pnl_pct': np.float64(-0.050475000000000006), 'commission': np.float64(19.281016483516485), 'initial_capital': 10000, 'final_capital': np.float64(9481.515686813189)}
 DEBUG: Result 10 keys: ['stop_loss', 'metrics', 'trades', 'test_num', 'total_tests']
 DEBUG: Result 10 has parameter 'stop_loss': True
 DEBUG: Extracted param_value for 'stop_loss': 0.055 (type: float)
 DEBUG: Result Metrics: {'total_return_pct': np.float64(-0.42907251480119724), 'total_pnl_pct': np.float64(-0.42907251480119724), 'total_pnl': np.float64(-4290.725148011972), 'max_drawdown_pct': np.float64(-0.8365026038744277), 'max_drawdown': np.float64(-0.8365026038744277), 'cagr': np.float64(-0.06467226616058697), 'num_trades': 189, 'total_trades': 189, 'win_rate': 0.37037037037037035, 'profit_factor': np.float64(0.8572956706920445), 'avg_trade_return': np.float64(-22.702249460380823), 'sharpe': np.float64(-0.2639202910730866), 'sharpe_ratio': np.float64(-0.2639202910730866), 'final_equity': np.float64(5709.274851988028), 'duration_days': 3062, 'monthly_return_avg': np.float64(0.0028530618881390346), 'avg_drawdown': np.float64(0.5884928188876183), 'max_dd_duration_days': 2859, 'recovery_factor': np.float64(0.5129362572380084), 'sortino_ratio': np.float64(0.18612758566129456), 'calmar_ratio': np.float64(-0.07731268959719258), 'expectancy': np.float64(-22.702249460380898), 'max_consecutive_wins': 9, 'max_consecutive_losses': 15, 'trade_concentration_top_10_pct': np.float64(0.39776082796610895), 'benchmark': {'return_pct': np.float64(20.284536286290315), 'cagr': np.float64(0.43984068388293496), 'final_value': np.float64(212845.36286290316)}, 'alpha': np.float64(-0.5045129500435219), 'avg_atr': 623.2955836989505, 'avg_adx': 28.24622105493285, 'regime_performance': {'Unknown': {'count': 4, 'wins': 0, 'losses': 4, 'pnl': np.float64(-2085.184015410431), 'win_rate': 0.0}, 'Bear': {'count': 161, 'wins': 60, 'losses': 101, 'pnl': np.float64(-1666.001396205636), 'win_rate': 37.267080745341616}, 'Bull': {'count': 24, 'wins': 10, 'losses': 14, 'pnl': np.float64(-539.5397363959073), 'win_rate': 41.66666666666667}}, 'criteria_result': {'status': 'NO-GO', 'reasons': ['Sharpe Ratio muito baixo: -0.26 < 0.8', 'CAGR não supera Buy & Hold: -6.5% ≤ 44.0%', 'Calmar Ratio baixo: -0.08 < 1.0', 'Profit Factor baixo: 0.86 < 1.3', 'Expectancy negativa ou zero: $-22.70'], 'warnings': []}, 'strategy': 'rsi', 'timeframe': '4h'}
 DEBUG: full_params after assignment: {'length': 15, 'overbought': 70, 'oversold': 30, 'timeframe': '4h', 'stop_loss': 0.055}
 DEBUG: result_data has 189 trades
 DEBUG: First trade sample: {'entry_time': '2017-09-04T16:00:00.000000000', 'exit_time': '2017-09-05T00:00:00.000000000', 'side': 'long', 'reason': 'SL', 'entry_price': np.float64(4205.771835), 'exit_price': np.float64(3972.467156882962), 'size': np.float64(2.3515564510193863), 'pnl_gross': np.float64(-548.6291208791207), 'pnl': np.float64(-567.8607115384614), 'pnl_pct': np.float64(-0.05547249999999998), 'commission': np.float64(19.23159065934066), 'initial_capital': 10000, 'final_capital': np.float64(9432.139288461538)}
 DEBUG: Result 11 keys: ['stop_loss', 'metrics', 'trades', 'test_num', 'total_tests']
 DEBUG: Result 11 has parameter 'stop_loss': True
 DEBUG: Extracted param_value for 'stop_loss': 0.06 (type: float)
 DEBUG: Result Metrics: {'total_return_pct': np.float64(-0.663907137109347), 'total_pnl_pct': np.float64(-0.663907137109347), 'total_pnl': np.float64(-6639.071371093471), 'max_drawdown_pct': np.float64(-0.8745370050139736), 'max_drawdown': np.float64(-0.8745370050139736), 'cagr': np.float64(-0.12196101299514261), 'num_trades': 181, 'total_trades': 181, 'win_rate': 0.3756906077348066, 'profit_factor': np.float64(0.7634656822197289), 'avg_trade_return': np.float64(-36.679952326483225), 'sharpe': np.float64(-0.44115206501063703), 'sharpe_ratio': np.float64(-0.44115206501063703), 'final_equity': np.float64(3360.9286289065294), 'duration_days': 3062, 'monthly_return_avg': np.float64(-0.002343474301937732), 'avg_drawdown': np.float64(0.6371915313315033), 'max_dd_duration_days': 3044, 'recovery_factor': np.float64(0.7591527097229452), 'sortino_ratio': np.float64(-0.8020527683585018), 'calmar_ratio': np.float64(-0.13945780715499156), 'expectancy': np.float64(-36.6799523264832), 'max_consecutive_wins': 8, 'max_consecutive_losses': 9, 'trade_concentration_top_10_pct': np.float64(0.45387201175582514), 'benchmark': {'return_pct': np.float64(20.284536286290315), 'cagr': np.float64(0.43984068388293496), 'final_value': np.float64(212845.36286290316)}, 'alpha': np.float64(-0.5618016968780776), 'avg_atr': 623.2955836989505, 'avg_adx': 28.24622105493285, 'regime_performance': {'Unknown': {'count': 4, 'wins': 0, 'losses': 4, 'pnl': np.float64(-2249.6205431460185), 'win_rate': 0.0}, 'Bear': {'count': 154, 'wins': 59, 'losses': 95, 'pnl': np.float64(-2916.1589938529432), 'win_rate': 38.311688311688314}, 'Bull': {'count': 23, 'wins': 9, 'losses': 14, 'pnl': np.float64(-1473.2918340945025), 'win_rate': 39.130434782608695}}, 'criteria_result': {'status': 'NO-GO', 'reasons': ['Sharpe Ratio muito baixo: -0.44 < 0.8', 'CAGR não supera Buy & Hold: -12.2% ≤ 44.0%', 'Calmar Ratio baixo: -0.14 < 1.0', 'Profit Factor baixo: 0.76 < 1.3', 'Expectancy negativa ou zero: $-36.68'], 'warnings': []}, 'strategy': 'rsi', 'timeframe': '4h'}
 DEBUG: full_params after assignment: {'length': 15, 'overbought': 70, 'oversold': 30, 'timeframe': '4h', 'stop_loss': 0.06}
 DEBUG: result_data has 181 trades
 DEBUG: First trade sample: {'entry_time': '2017-09-04T16:00:00.000000000', 'exit_time': '2017-09-05T00:00:00.000000000', 'side': 'long', 'reason': 'SL', 'entry_price': np.float64(4205.771835), 'exit_price': np.float64(3951.4488121375493), 'size': np.float64(2.3515564510193863), 'pnl_gross': np.float64(-598.0549450549456), 'pnl': np.float64(-617.2371098901104), 'pnl_pct': np.float64(-0.06047000000000006), 'commission': np.float64(19.182164835164834), 'initial_capital': 10000, 'final_capital': np.float64(9382.762890109889)}
 DEBUG: Result 12 keys: ['stop_loss', 'metrics', 'trades', 'test_num', 'total_tests']
 DEBUG: Result 12 has parameter 'stop_loss': True
 DEBUG: Extracted param_value for 'stop_loss': 0.065 (type: float)
 DEBUG: Result Metrics: {'total_return_pct': np.float64(0.03536155233453301), 'total_pnl_pct': np.float64(0.03536155233453301), 'total_pnl': np.float64(353.6155233453301), 'max_drawdown_pct': np.float64(-0.7006284220566891), 'max_drawdown': np.float64(-0.7006284220566891), 'cagr': np.float64(0.004153831992728563), 'num_trades': 174, 'total_trades': 174, 'win_rate': 0.43103448275862066, 'profit_factor': np.float64(1.0077449724120753), 'avg_trade_return': np.float64(2.032273122674282), 'sharpe': np.float64(0.01470867874106323), 'sharpe_ratio': np.float64(0.01470867874106323), 'final_equity': np.float64(10353.61552334533), 'duration_days': 3062, 'monthly_return_avg': np.float64(0.008737226730578645), 'avg_drawdown': np.float64(0.37651582832964153), 'max_dd_duration_days': 2394, 'recovery_factor': np.float64(-0.050471193033718824), 'sortino_ratio': np.float64(1.3514522955967665), 'calmar_ratio': np.float64(0.005928723217558064), 'expectancy': np.float64(2.032273122674326), 'max_consecutive_wins': 8, 'max_consecutive_losses': 8, 'trade_concentration_top_10_pct': np.float64(0.314385442246475), 'benchmark': {'return_pct': np.float64(20.284536286290315), 'cagr': np.float64(0.43984068388293496), 'final_value': np.float64(212845.36286290316)}, 'alpha': np.float64(-0.4356868518902064), 'avg_atr': 623.2955836989505, 'avg_adx': 28.24622105493285, 'regime_performance': {'Unknown': {'count': 4, 'wins': 0, 'losses': 4, 'pnl': np.float64(-2411.4814404375607), 'win_rate': 0.0}, 'Bear': {'count': 148, 'wins': 65, 'losses': 83, 'pnl': np.float64(2991.3293180145442), 'win_rate': 43.91891891891892}, 'Bull': {'count': 22, 'wins': 10, 'losses': 12, 'pnl': np.float64(-226.23235423165943), 'win_rate': 45.45454545454545}}, 'criteria_result': {'status': 'NO-GO', 'reasons': ['Sharpe Ratio muito baixo: 0.01 < 0.8', 'CAGR não supera Buy & Hold: 0.4% ≤ 44.0%', 'Calmar Ratio baixo: 0.01 < 1.0', 'Profit Factor baixo: 1.01 < 1.3'], 'warnings': []}, 'strategy': 'rsi', 'timeframe': '4h'}
 DEBUG: full_params after assignment: {'length': 15, 'overbought': 70, 'oversold': 30, 'timeframe': '4h', 'stop_loss': 0.065}
 DEBUG: result_data has 174 trades
 DEBUG: First trade sample: {'entry_time': '2017-09-04T16:00:00.000000000', 'exit_time': '2017-09-05T00:00:00.000000000', 'side': 'long', 'reason': 'SL', 'entry_price': np.float64(4205.771835), 'exit_price': np.float64(3930.4304673921374), 'size': np.float64(2.3515564510193863), 'pnl_gross': np.float64(-647.4807692307685), 'pnl': np.float64(-666.6135082417575), 'pnl_pct': np.float64(-0.06546749999999991), 'commission': np.float64(19.132739010989013), 'initial_capital': 10000, 'final_capital': np.float64(9333.386491758243)}
 DEBUG: Result 13 keys: ['stop_loss', 'metrics', 'trades', 'test_num', 'total_tests']
 DEBUG: Result 13 has parameter 'stop_loss': True
 DEBUG: Extracted param_value for 'stop_loss': 0.07 (type: float)
 DEBUG: Result Metrics: {'total_return_pct': np.float64(0.28959025459560983), 'total_pnl_pct': np.float64(0.28959025459560983), 'total_pnl': np.float64(2895.902545956098), 'max_drawdown_pct': np.float64(-0.6932569964691165), 'max_drawdown': np.float64(-0.6932569964691165), 'cagr': np.float64(0.03080190369383229), 'num_trades': 167, 'total_trades': 167, 'win_rate': 0.46107784431137727, 'profit_factor': np.float64(1.0617587899303877), 'avg_trade_return': np.float64(17.340733808120298), 'sharpe': np.float64(0.11125697425106137), 'sharpe_ratio': np.float64(0.11125697425106137), 'final_equity': np.float64(12895.902545956098), 'duration_days': 3062, 'monthly_return_avg': np.float64(0.010860288803066477), 'avg_drawdown': np.float64(0.37594237617177506), 'max_dd_duration_days': 2281, 'recovery_factor': np.float64(-0.4177242437805105), 'sortino_ratio': np.float64(1.7078153151230837), 'calmar_ratio': np.float64(0.04443071451238424), 'expectancy': np.float64(17.340733808120376), 'max_consecutive_wins': 8, 'max_consecutive_losses': 7, 'trade_concentration_top_10_pct': np.float64(0.3062941771572007), 'benchmark': {'return_pct': np.float64(20.284536286290315), 'cagr': np.float64(0.43984068388293496), 'final_value': np.float64(212845.36286290316)}, 'alpha': np.float64(-0.40903878018910267), 'avg_atr': 623.2955836989505, 'avg_adx': 28.24622105493285, 'regime_performance': {'Unknown': {'count': 4, 'wins': 0, 'losses': 4, 'pnl': np.float64(-2570.793744127707), 'win_rate': 0.0}, 'Bear': {'count': 141, 'wins': 67, 'losses': 74, 'pnl': np.float64(5973.030307226322), 'win_rate': 47.5177304964539}, 'Bull': {'count': 22, 'wins': 10, 'losses': 12, 'pnl': np.float64(-506.3340171425249), 'win_rate': 45.45454545454545}}, 'criteria_result': {'status': 'NO-GO', 'reasons': ['Sharpe Ratio muito baixo: 0.11 < 0.8', 'CAGR não supera Buy & Hold: 3.1% ≤ 44.0%', 'Calmar Ratio baixo: 0.04 < 1.0', 'Profit Factor baixo: 1.06 < 1.3'], 'warnings': []}, 'strategy': 'rsi', 'timeframe': '4h'}
 DEBUG: full_params after assignment: {'length': 15, 'overbought': 70, 'oversold': 30, 'timeframe': '4h', 'stop_loss': 0.07}
 DEBUG: result_data has 167 trades
 DEBUG: First trade sample: {'entry_time': '2017-09-04T16:00:00.000000000', 'exit_time': '2017-09-05T00:00:00.000000000', 'side': 'long', 'reason': 'SL', 'entry_price': np.float64(4205.771835), 'exit_price': np.float64(3909.4121226467246), 'size': np.float64(2.3515564510193863), 'pnl_gross': np.float64(-696.9065934065935), 'pnl': np.float64(-715.9899065934067), 'pnl_pct': np.float64(-0.070465), 'commission': np.float64(19.083313186813186), 'initial_capital': 10000, 'final_capital': np.float64(9284.010093406594)}
 DEBUG: Result 14 keys: ['stop_loss', 'metrics', 'trades', 'test_num', 'total_tests']
 DEBUG: Result 14 has parameter 'stop_loss': True
 DEBUG: Extracted param_value for 'stop_loss': 0.075 (type: float)
 DEBUG: Result Metrics: {'total_return_pct': np.float64(-0.1724028963692639), 'total_pnl_pct': np.float64(-0.1724028963692639), 'total_pnl': np.float64(-1724.028963692639), 'max_drawdown_pct': np.float64(-0.7330672673776748), 'max_drawdown': np.float64(-0.7330672673776748), 'cagr': np.float64(-0.0223192756046523), 'num_trades': 161, 'total_trades': 161, 'win_rate': 0.4720496894409938, 'profit_factor': np.float64(0.9549022327576474), 'avg_trade_return': np.float64(-10.708254432873582), 'sharpe': np.float64(-0.08467749582765022), 'sharpe_ratio': np.float64(-0.08467749582765022), 'final_equity': np.float64(8275.971036307361), 'duration_days': 3062, 'monthly_return_avg': np.float64(0.0066984287187418145), 'avg_drawdown': np.float64(0.44157747391872104), 'max_dd_duration_days': 2690, 'recovery_factor': np.float64(0.23518018610486155), 'sortino_ratio': np.float64(0.8616982028283505), 'calmar_ratio': np.float64(-0.03044642231059193), 'expectancy': np.float64(-10.708254432873588), 'max_consecutive_wins': 10, 'max_consecutive_losses': 8, 'trade_concentration_top_10_pct': np.float64(0.3354145706490746), 'benchmark': {'return_pct': np.float64(20.284536286290315), 'cagr': np.float64(0.43984068388293496), 'final_value': np.float64(212845.36286290316)}, 'alpha': np.float64(-0.46215995948758726), 'avg_atr': 623.2955836989505, 'avg_adx': 28.24622105493285, 'regime_performance': {'Unknown': {'count': 4, 'wins': 0, 'losses': 4, 'pnl': np.float64(-2727.584348403464), 'win_rate': 0.0}, 'Bear': {'count': 135, 'wins': 66, 'losses': 69, 'pnl': np.float64(1996.2961135893142), 'win_rate': 48.888888888888886}, 'Bull': {'count': 22, 'wins': 10, 'losses': 12, 'pnl': np.float64(-992.7407288784993), 'win_rate': 45.45454545454545}}, 'criteria_result': {'status': 'NO-GO', 'reasons': ['Sharpe Ratio muito baixo: -0.08 < 0.8', 'CAGR não supera Buy & Hold: -2.2% ≤ 44.0%', 'Calmar Ratio baixo: -0.03 < 1.0', 'Profit Factor baixo: 0.95 < 1.3', 'Expectancy negativa ou zero: $-10.71'], 'warnings': []}, 'strategy': 'rsi', 'timeframe': '4h'}
 DEBUG: full_params after assignment: {'length': 15, 'overbought': 70, 'oversold': 30, 'timeframe': '4h', 'stop_loss': 0.075}
 DEBUG: result_data has 161 trades
 DEBUG: First trade sample: {'entry_time': '2017-09-04T16:00:00.000000000', 'exit_time': '2017-09-05T00:00:00.000000000', 'side': 'long', 'reason': 'SL', 'entry_price': np.float64(4205.771835), 'exit_price': np.float64(3888.3937779013127), 'size': np.float64(2.3515564510193863), 'pnl_gross': np.float64(-746.3324175824163), 'pnl': np.float64(-765.3663049450537), 'pnl_pct': np.float64(-0.07546249999999986), 'commission': np.float64(19.033887362637365), 'initial_capital': 10000, 'final_capital': np.float64(9234.633695054947)}
 DEBUG: Result 15 keys: ['stop_loss', 'metrics', 'trades', 'test_num', 'total_tests']
 DEBUG: Result 15 has parameter 'stop_loss': True
 DEBUG: Extracted param_value for 'stop_loss': 0.08 (type: float)
 DEBUG: Result Metrics: {'total_return_pct': np.float64(-0.005864765436163362), 'total_pnl_pct': np.float64(-0.005864765436163362), 'total_pnl': np.float64(-58.64765436163361), 'max_drawdown_pct': np.float64(-0.7683997058808063), 'max_drawdown': np.float64(-0.7683997058808063), 'cagr': np.float64(-0.0007013906567552297), 'num_trades': 159, 'total_trades': 159, 'win_rate': 0.49056603773584906, 'profit_factor': np.float64(0.9984545909845823), 'avg_trade_return': np.float64(-0.3688531720858661), 'sharpe': np.float64(-0.0028034053707649944), 'sharpe_ratio': np.float64(-0.0028034053707649944), 'final_equity': np.float64(9941.352345638366), 'duration_days': 3062, 'monthly_return_avg': np.float64(0.008805652263738103), 'avg_drawdown': np.float64(0.444959641230824), 'max_dd_duration_days': 2597, 'recovery_factor': np.float64(0.007632441021617284), 'sortino_ratio': np.float64(1.185222753804321), 'calmar_ratio': np.float64(-0.0009127940203350742), 'expectancy': np.float64(-0.3688531720859203), 'max_consecutive_wins': 10, 'max_consecutive_losses': 6, 'trade_concentration_top_10_pct': np.float64(0.3187578956300966), 'benchmark': {'return_pct': np.float64(20.284536286290315), 'cagr': np.float64(0.43984068388293496), 'final_value': np.float64(212845.36286290316)}, 'alpha': np.float64(-0.4405420745396902), 'avg_atr': 623.2955836989505, 'avg_adx': 28.24622105493285, 'regime_performance': {'Unknown': {'count': 4, 'wins': 0, 'losses': 4, 'pnl': np.float64(-2881.8800047962395), 'win_rate': 0.0}, 'Bear': {'count': 133, 'wins': 68, 'losses': 65, 'pnl': np.float64(4428.800791189212), 'win_rate': 51.127819548872175}, 'Bull': {'count': 22, 'wins': 10, 'losses': 12, 'pnl': np.float64(-1605.5684407546241), 'win_rate': 45.45454545454545}}, 'criteria_result': {'status': 'NO-GO', 'reasons': ['Sharpe Ratio muito baixo: -0.00 < 0.8', 'CAGR não supera Buy & Hold: -0.1% ≤ 44.0%', 'Calmar Ratio baixo: -0.00 < 1.0', 'Profit Factor baixo: 1.00 < 1.3', 'Expectancy negativa ou zero: $-0.37'], 'warnings': []}, 'strategy': 'rsi', 'timeframe': '4h'}
 DEBUG: full_params after assignment: {'length': 15, 'overbought': 70, 'oversold': 30, 'timeframe': '4h', 'stop_loss': 0.08}
 DEBUG: result_data has 159 trades
 DEBUG: First trade sample: {'entry_time': '2017-09-04T16:00:00.000000000', 'exit_time': '2017-09-05T00:00:00.000000000', 'side': 'long', 'reason': 'SL', 'entry_price': np.float64(4205.771835), 'exit_price': np.float64(3867.3754331559003), 'size': np.float64(2.3515564510193863), 'pnl_gross': np.float64(-795.7582417582402), 'pnl': np.float64(-814.7427032967017), 'pnl_pct': np.float64(-0.08045999999999984), 'commission': np.float64(18.98446153846154), 'initial_capital': 10000, 'final_capital': np.float64(9185.2572967033)}
 DEBUG: Result 16 keys: ['stop_loss', 'metrics', 'trades', 'test_num', 'total_tests']
 DEBUG: Result 16 has parameter 'stop_loss': True
 DEBUG: Extracted param_value for 'stop_loss': 0.085 (type: float)
 DEBUG: Result Metrics: {'total_return_pct': np.float64(-0.06046285724807058), 'total_pnl_pct': np.float64(-0.06046285724807058), 'total_pnl': np.float64(-604.6285724807058), 'max_drawdown_pct': np.float64(-0.793402275813981), 'max_drawdown': np.float64(-0.793402275813981), 'cagr': np.float64(-0.007411939531346556), 'num_trades': 155, 'total_trades': 155, 'win_rate': 0.5032258064516129, 'profit_factor': np.float64(0.9827059198623138), 'avg_trade_return': np.float64(-3.9008294998755737), 'sharpe': np.float64(-0.030709446759687942), 'sharpe_ratio': np.float64(-0.030709446759687942), 'final_equity': np.float64(9395.371427519294), 'duration_days': 3062, 'monthly_return_avg': np.float64(0.008369933891560592), 'avg_drawdown': np.float64(0.4932638224307533), 'max_dd_duration_days': 2681, 'recovery_factor': np.float64(0.07620706303878375), 'sortino_ratio': np.float64(1.1019623334068875), 'calmar_ratio': np.float64(-0.009341969083391362), 'expectancy': np.float64(-3.900829499875641), 'max_consecutive_wins': 10, 'max_consecutive_losses': 6, 'trade_concentration_top_10_pct': np.float64(0.33606684132546183), 'benchmark': {'return_pct': np.float64(20.284536286290315), 'cagr': np.float64(0.43984068388293496), 'final_value': np.float64(212845.36286290316)}, 'alpha': np.float64(-0.4472526234142815), 'avg_atr': 623.2955836989505, 'avg_adx': 28.24622105493285, 'regime_performance': {'Unknown': {'count': 4, 'wins': 0, 'losses': 4, 'pnl': np.float64(-3033.7073221818223), 'win_rate': 0.0}, 'Bear': {'count': 129, 'wins': 68, 'losses': 61, 'pnl': np.float64(4511.015356287683), 'win_rate': 52.71317829457365}, 'Bull': {'count': 22, 'wins': 10, 'losses': 12, 'pnl': np.float64(-2081.936606586575), 'win_rate': 45.45454545454545}}, 'criteria_result': {'status': 'NO-GO', 'reasons': ['Sharpe Ratio muito baixo: -0.03 < 0.8', 'CAGR não supera Buy & Hold: -0.7% ≤ 44.0%', 'Calmar Ratio baixo: -0.01 < 1.0', 'Profit Factor baixo: 0.98 < 1.3', 'Expectancy negativa ou zero: $-3.90'], 'warnings': []}, 'strategy': 'rsi', 'timeframe': '4h'}
 DEBUG: full_params after assignment: {'length': 15, 'overbought': 70, 'oversold': 30, 'timeframe': '4h', 'stop_loss': 0.085}
 DEBUG: result_data has 155 trades
 DEBUG: First trade sample: {'entry_time': '2017-09-04T16:00:00.000000000', 'exit_time': '2017-09-05T00:00:00.000000000', 'side': 'long', 'reason': 'SL', 'entry_price': np.float64(4205.771835), 'exit_price': np.float64(3846.3570884104874), 'size': np.float64(2.3515564510193863), 'pnl_gross': np.float64(-845.1840659340652), 'pnl': np.float64(-864.1191016483509), 'pnl_pct': np.float64(-0.08545749999999991), 'commission': np.float64(18.935035714285718), 'initial_capital': 10000, 'final_capital': np.float64(9135.88089835165)}
 DEBUG: Result 17 keys: ['stop_loss', 'metrics', 'trades', 'test_num', 'total_tests']
 DEBUG: Result 17 has parameter 'stop_loss': True
 DEBUG: Extracted param_value for 'stop_loss': 0.09 (type: float)
 DEBUG: Result Metrics: {'total_return_pct': np.float64(0.10712097829763788), 'total_pnl_pct': np.float64(0.10712097829763788), 'total_pnl': np.float64(1071.2097829763788), 'max_drawdown_pct': np.float64(-0.7773757934497909), 'max_drawdown': np.float64(-0.7773757934497909), 'cagr': np.float64(0.012212743017997019), 'num_trades': 150, 'total_trades': 150, 'win_rate': 0.5266666666666666, 'profit_factor': np.float64(1.0294573730122856), 'avg_trade_return': np.float64(7.141398553175859), 'sharpe': np.float64(0.05094750393230359), 'sharpe_ratio': np.float64(0.05094750393230359), 'final_equity': np.float64(11071.209782976379), 'duration_days': 3062, 'monthly_return_avg': np.float64(0.009310566810883223), 'avg_drawdown': np.float64(0.4661415593675539), 'max_dd_duration_days': 2545, 'recovery_factor': np.float64(-0.1377981912998126), 'sortino_ratio': np.float64(1.34274805555723), 'calmar_ratio': np.float64(0.015710217787718927), 'expectancy': np.float64(7.141398553175833), 'max_consecutive_wins': 10, 'max_consecutive_losses': 5, 'trade_concentration_top_10_pct': np.float64(0.3245860182567435), 'benchmark': {'return_pct': np.float64(20.284536286290315), 'cagr': np.float64(0.43984068388293496), 'final_value': np.float64(212845.36286290316)}, 'alpha': np.float64(-0.42762794086493794), 'avg_atr': 623.2955836989505, 'avg_adx': 28.24622105493285, 'regime_performance': {'Unknown': {'count': 4, 'wins': 0, 'losses': 4, 'pnl': np.float64(-3183.092766780378), 'win_rate': 0.0}, 'Bear': {'count': 124, 'wins': 69, 'losses': 55, 'pnl': np.float64(6632.74087573022), 'win_rate': 55.64516129032258}, 'Bull': {'count': 22, 'wins': 10, 'losses': 12, 'pnl': np.float64(-2378.4383259734627), 'win_rate': 45.45454545454545}}, 'criteria_result': {'status': 'NO-GO', 'reasons': ['Sharpe Ratio muito baixo: 0.05 < 0.8', 'CAGR não supera Buy & Hold: 1.2% ≤ 44.0%', 'Calmar Ratio baixo: 0.02 < 1.0', 'Profit Factor baixo: 1.03 < 1.3'], 'warnings': []}, 'strategy': 'rsi', 'timeframe': '4h'}
 DEBUG: full_params after assignment: {'length': 15, 'overbought': 70, 'oversold': 30, 'timeframe': '4h', 'stop_loss': 0.09}
 DEBUG: result_data has 150 trades
 DEBUG: First trade sample: {'entry_time': '2017-09-04T16:00:00.000000000', 'exit_time': '2017-09-05T00:00:00.000000000', 'side': 'long', 'reason': 'SL', 'entry_price': np.float64(4205.771835), 'exit_price': np.float64(3825.338743665075), 'size': np.float64(2.3515564510193863), 'pnl_gross': np.float64(-894.6098901098891), 'pnl': np.float64(-913.495499999999), 'pnl_pct': np.float64(-0.09045499999999988), 'commission': np.float64(18.88560989010989), 'initial_capital': 10000, 'final_capital': np.float64(9086.504500000001)}
 DEBUG: Result 18 keys: ['stop_loss', 'metrics', 'trades', 'test_num', 'total_tests']
 DEBUG: Result 18 has parameter 'stop_loss': True
 DEBUG: Extracted param_value for 'stop_loss': 0.095 (type: float)
 DEBUG: Result Metrics: {'total_return_pct': np.float64(0.2618597165255351), 'total_pnl_pct': np.float64(0.2618597165255351), 'total_pnl': np.float64(2618.597165255351), 'max_drawdown_pct': np.float64(-0.7289935675859553), 'max_drawdown': np.float64(-0.7289935675859553), 'cagr': np.float64(0.028132491473743082), 'num_trades': 147, 'total_trades': 147, 'win_rate': 0.54421768707483, 'profit_factor': np.float64(1.0649002450782588), 'avg_trade_return': np.float64(17.81358615819971), 'sharpe': np.float64(0.10936353240464532), 'sharpe_ratio': np.float64(0.10936353240464532), 'final_equity': np.float64(12618.59716525535), 'duration_days': 3062, 'monthly_return_avg': np.float64(0.010021797128603755), 'avg_drawdown': np.float64(0.4184463553210178), 'max_dd_duration_days': 2407, 'recovery_factor': np.float64(-0.35920717022603793), 'sortino_ratio': np.float64(1.5329331071620205), 'calmar_ratio': np.float64(0.038590863794454526), 'expectancy': np.float64(17.813586158199826), 'max_consecutive_wins': 10, 'max_consecutive_losses': 5, 'trade_concentration_top_10_pct': np.float64(0.3214295081134299), 'benchmark': {'return_pct': np.float64(20.284536286290315), 'cagr': np.float64(0.43984068388293496), 'final_value': np.float64(212845.36286290316)}, 'alpha': np.float64(-0.4117081924091919), 'avg_atr': 623.2955836989505, 'avg_adx': 28.24622105493285, 'regime_performance': {'Unknown': {'count': 4, 'wins': 1, 'losses': 3, 'pnl': np.float64(-1975.571548588523), 'win_rate': 25.0}, 'Bear': {'count': 121, 'wins': 69, 'losses': 52, 'pnl': np.float64(7735.309635391287), 'win_rate': 57.02479338842975}, 'Bull': {'count': 22, 'wins': 10, 'losses': 12, 'pnl': np.float64(-3141.1409215474046), 'win_rate': 45.45454545454545}}, 'criteria_result': {'status': 'NO-GO', 'reasons': ['Sharpe Ratio muito baixo: 0.11 < 0.8', 'CAGR não supera Buy & Hold: 2.8% ≤ 44.0%', 'Calmar Ratio baixo: 0.04 < 1.0', 'Profit Factor baixo: 1.06 < 1.3'], 'warnings': []}, 'strategy': 'rsi', 'timeframe': '4h'}
 DEBUG: full_params after assignment: {'length': 15, 'overbought': 70, 'oversold': 30, 'timeframe': '4h', 'stop_loss': 0.095}
 DEBUG: result_data has 147 trades
 DEBUG: First trade sample: {'entry_time': '2017-09-04T16:00:00.000000000', 'exit_time': '2017-09-05T00:00:00.000000000', 'side': 'long', 'reason': 'SL', 'entry_price': np.float64(4205.771835), 'exit_price': np.float64(3804.3203989196622), 'size': np.float64(2.3515564510193863), 'pnl_gross': np.float64(-944.035714285714), 'pnl': np.float64(-962.871898351648), 'pnl_pct': np.float64(-0.09545249999999997), 'commission': np.float64(18.836184065934066), 'initial_capital': 10000, 'final_capital': np.float64(9037.128101648352)}
 DEBUG: Result 19 keys: ['stop_loss', 'metrics', 'trades', 'test_num', 'total_tests']
 DEBUG: Result 19 has parameter 'stop_loss': True
 DEBUG: Extracted param_value for 'stop_loss': 0.1 (type: float)
 DEBUG: Result Metrics: {'total_return_pct': np.float64(0.3635752565621442), 'total_pnl_pct': np.float64(0.3635752565621442), 'total_pnl': np.float64(3635.752565621442), 'max_drawdown_pct': np.float64(-0.7014631444443832), 'max_drawdown': np.float64(-0.7014631444443832), 'cagr': np.float64(0.03768411463249888), 'num_trades': 142, 'total_trades': 142, 'win_rate': 0.5633802816901409, 'profit_factor': np.float64(1.0888003205751995), 'avg_trade_return': np.float64(25.603891307193287), 'sharpe': np.float64(0.14633555047831695), 'sharpe_ratio': np.float64(0.14633555047831695), 'final_equity': np.float64(13635.752565621442), 'duration_days': 3062, 'monthly_return_avg': np.float64(0.011260542448277356), 'avg_drawdown': np.float64(0.39677009265031327), 'max_dd_duration_days': 2407, 'recovery_factor': np.float64(-0.5183098491227588), 'sortino_ratio': np.float64(1.652994408854782), 'calmar_ratio': np.float64(0.05372215907700727), 'expectancy': np.float64(25.603891307193294), 'max_consecutive_wins': 10, 'max_consecutive_losses': 5, 'trade_concentration_top_10_pct': np.float64(0.31713793865014067), 'benchmark': {'return_pct': np.float64(20.284536286290315), 'cagr': np.float64(0.43984068388293496), 'final_value': np.float64(212845.36286290316)}, 'alpha': np.float64(-0.4021565692504361), 'avg_atr': 623.2955836989505, 'avg_adx': 28.24622105493285, 'regime_performance': {'Unknown': {'count': 4, 'wins': 1, 'losses': 3, 'pnl': np.float64(-2106.3840668567855), 'win_rate': 25.0}, 'Bear': {'count': 116, 'wins': 69, 'losses': 47, 'pnl': np.float64(9189.134984365646), 'win_rate': 59.48275862068966}, 'Bull': {'count': 22, 'wins': 10, 'losses': 12, 'pnl': np.float64(-3446.99835188741), 'win_rate': 45.45454545454545}}, 'criteria_result': {'status': 'NO-GO', 'reasons': ['Sharpe Ratio muito baixo: 0.15 < 0.8', 'CAGR não supera Buy & Hold: 3.8% ≤ 44.0%', 'Calmar Ratio baixo: 0.05 < 1.0', 'Profit Factor baixo: 1.09 < 1.3'], 'warnings': []}, 'strategy': 'rsi', 'timeframe': '4h'}
 DEBUG: full_params after assignment: {'length': 15, 'overbought': 70, 'oversold': 30, 'timeframe': '4h', 'stop_loss': 0.1}
 DEBUG: result_data has 142 trades
 DEBUG: First trade sample: {'entry_time': '2017-09-04T16:00:00.000000000', 'exit_time': '2017-09-05T00:00:00.000000000', 'side': 'long', 'reason': 'SL', 'entry_price': np.float64(4205.771835), 'exit_price': np.float64(3783.30205417425), 'size': np.float64(2.3515564510193863), 'pnl_gross': np.float64(-993.4615384615379), 'pnl': np.float64(-1012.2482967032961), 'pnl_pct': np.float64(-0.10044999999999994), 'commission': np.float64(18.786758241758243), 'initial_capital': 10000, 'final_capital': np.float64(8987.751703296704)}
 DEBUG: Result 20 keys: ['stop_loss', 'metrics', 'trades', 'test_num', 'total_tests']
 DEBUG: Result 20 has parameter 'stop_loss': True
 DEBUG: Extracted param_value for 'stop_loss': 0.105 (type: float)
 DEBUG: Result Metrics: {'total_return_pct': np.float64(0.16352019497181028), 'total_pnl_pct': np.float64(0.16352019497181028), 'total_pnl': np.float64(1635.2019497181027), 'max_drawdown_pct': np.float64(-0.7369344159704142), 'max_drawdown': np.float64(-0.7369344159704142), 'cagr': np.float64(0.018229859015580052), 'num_trades': 140, 'total_trades': 140, 'win_rate': 0.5714285714285714, 'profit_factor': np.float64(1.0425907012450892), 'avg_trade_return': np.float64(11.680013926557754), 'sharpe': np.float64(0.07052305097486893), 'sharpe_ratio': np.float64(0.07052305097486893), 'final_equity': np.float64(11635.201949718103), 'duration_days': 3062, 'monthly_return_avg': np.float64(0.009974852796532308), 'avg_drawdown': np.float64(0.4569313633563453), 'max_dd_duration_days': 2582, 'recovery_factor': np.float64(-0.22189246617893774), 'sortino_ratio': np.float64(1.3985988192792982), 'calmar_ratio': np.float64(0.024737423874517387), 'expectancy': np.float64(11.680013926557763), 'max_consecutive_wins': 10, 'max_consecutive_losses': 5, 'trade_concentration_top_10_pct': np.float64(0.32797841137605105), 'benchmark': {'return_pct': np.float64(20.284536286290315), 'cagr': np.float64(0.43984068388293496), 'final_value': np.float64(212845.36286290316)}, 'alpha': np.float64(-0.4216108248673549), 'avg_atr': 623.2955836989505, 'avg_adx': 28.24622105493285, 'regime_performance': {'Unknown': {'count': 3, 'wins': 1, 'losses': 2, 'pnl': np.float64(-1313.5971769028752), 'win_rate': 33.33333333333333}, 'Bear': {'count': 115, 'wins': 69, 'losses': 46, 'pnl': np.float64(6925.299700921425), 'win_rate': 60.0}, 'Bull': {'count': 22, 'wins': 10, 'losses': 12, 'pnl': np.float64(-3976.500574300464), 'win_rate': 45.45454545454545}}, 'criteria_result': {'status': 'NO-GO', 'reasons': ['Sharpe Ratio muito baixo: 0.07 < 0.8', 'CAGR não supera Buy & Hold: 1.8% ≤ 44.0%', 'Calmar Ratio baixo: 0.02 < 1.0', 'Profit Factor baixo: 1.04 < 1.3'], 'warnings': []}, 'strategy': 'rsi', 'timeframe': '4h'}
 DEBUG: full_params after assignment: {'length': 15, 'overbought': 70, 'oversold': 30, 'timeframe': '4h', 'stop_loss': 0.105}
 DEBUG: result_data has 140 trades
 DEBUG: First trade sample: {'entry_time': '2017-09-04T16:00:00.000000000', 'exit_time': '2017-09-05T00:00:00.000000000', 'side': 'long', 'reason': 'SL', 'entry_price': np.float64(4205.771835), 'exit_price': np.float64(3762.283709428837), 'size': np.float64(2.3515564510193863), 'pnl_gross': np.float64(-1042.887362637363), 'pnl': np.float64(-1061.6246950549453), 'pnl_pct': np.float64(-0.10544750000000001), 'commission': np.float64(18.73733241758242), 'initial_capital': 10000, 'final_capital': np.float64(8938.375304945055)}
 DEBUG: Result 21 keys: ['stop_loss', 'metrics', 'trades', 'test_num', 'total_tests']
 DEBUG: Result 21 has parameter 'stop_loss': True
 DEBUG: Extracted param_value for 'stop_loss': 0.11 (type: float)
 DEBUG: Result Metrics: {'total_return_pct': np.float64(0.18137993157355614), 'total_pnl_pct': np.float64(0.18137993157355614), 'total_pnl': np.float64(1813.7993157355613), 'max_drawdown_pct': np.float64(-0.7584454311025035), 'max_drawdown': np.float64(-0.7584454311025035), 'cagr': np.float64(0.020081746486480423), 'num_trades': 137, 'total_trades': 137, 'win_rate': 0.5766423357664233, 'profit_factor': np.float64(1.045832725050855), 'avg_trade_return': np.float64(13.239411063763168), 'sharpe': np.float64(0.07437438649578752), 'sharpe_ratio': np.float64(0.07437438649578752), 'final_equity': np.float64(11813.799315735561), 'duration_days': 3062, 'monthly_return_avg': np.float64(0.010432174429054811), 'avg_drawdown': np.float64(0.43785786640460755), 'max_dd_duration_days': 2582, 'recovery_factor': np.float64(-0.23914697634857612), 'sortino_ratio': np.float64(1.4279347033105696), 'calmar_ratio': np.float64(0.026477510000012625), 'expectancy': np.float64(13.23941106376327), 'max_consecutive_wins': 11, 'max_consecutive_losses': 4, 'trade_concentration_top_10_pct': np.float64(0.33293547818279146), 'benchmark': {'return_pct': np.float64(20.284536286290315), 'cagr': np.float64(0.43984068388293496), 'final_value': np.float64(212845.36286290316)}, 'alpha': np.float64(-0.41975893739645453), 'avg_atr': 623.2955836989505, 'avg_adx': 28.24622105493285, 'regime_performance': {'Unknown': {'count': 3, 'wins': 1, 'losses': 2, 'pnl': np.float64(-1409.3010651506117), 'win_rate': 33.33333333333333}, 'Bear': {'count': 112, 'wins': 67, 'losses': 45, 'pnl': np.float64(6442.557951130552), 'win_rate': 59.82142857142857}, 'Bull': {'count': 22, 'wins': 11, 'losses': 11, 'pnl': np.float64(-3219.4575702443863), 'win_rate': 50.0}}, 'criteria_result': {'status': 'NO-GO', 'reasons': ['Sharpe Ratio muito baixo: 0.07 < 0.8', 'CAGR não supera Buy & Hold: 2.0% ≤ 44.0%', 'Calmar Ratio baixo: 0.03 < 1.0', 'Profit Factor baixo: 1.05 < 1.3'], 'warnings': []}, 'strategy': 'rsi', 'timeframe': '4h'}
 DEBUG: full_params after assignment: {'length': 15, 'overbought': 70, 'oversold': 30, 'timeframe': '4h', 'stop_loss': 0.11}
 DEBUG: result_data has 137 trades
 DEBUG: First trade sample: {'entry_time': '2017-09-04T16:00:00.000000000', 'exit_time': '2017-09-05T00:00:00.000000000', 'side': 'long', 'reason': 'SL', 'entry_price': np.float64(4205.771835), 'exit_price': np.float64(3741.2653646834247), 'size': np.float64(2.3515564510193863), 'pnl_gross': np.float64(-1092.3131868131868), 'pnl': np.float64(-1111.0010934065933), 'pnl_pct': np.float64(-0.11044499999999999), 'commission': np.float64(18.687906593406595), 'initial_capital': 10000, 'final_capital': np.float64(8888.998906593408)}
 DEBUG: Result 22 keys: ['stop_loss', 'metrics', 'trades', 'test_num', 'total_tests']
 DEBUG: Result 22 has parameter 'stop_loss': True
 DEBUG: Extracted param_value for 'stop_loss': 0.115 (type: float)
 DEBUG: Result Metrics: {'total_return_pct': np.float64(0.05553555042791468), 'total_pnl_pct': np.float64(0.05553555042791468), 'total_pnl': np.float64(555.3555042791468), 'max_drawdown_pct': np.float64(-0.7419758667649878), 'max_drawdown': np.float64(-0.7419758667649878), 'cagr': np.float64(0.006467963441169067), 'num_trades': 135, 'total_trades': 135, 'win_rate': 0.5851851851851851, 'profit_factor': np.float64(1.0139994145581679), 'avg_trade_return': np.float64(4.113744476141747), 'sharpe': np.float64(0.023023648718692155), 'sharpe_ratio': np.float64(0.023023648718692155), 'final_equity': np.float64(10555.355504279147), 'duration_days': 3062, 'monthly_return_avg': np.float64(0.008997203868602642), 'avg_drawdown': np.float64(0.4317425126382087), 'max_dd_duration_days': 2677, 'recovery_factor': np.float64(-0.07484818969928159), 'sortino_ratio': np.float64(1.254529030247125), 'calmar_ratio': np.float64(0.008717215385143676), 'expectancy': np.float64(4.113744476141733), 'max_consecutive_wins': 11, 'max_consecutive_losses': 4, 'trade_concentration_top_10_pct': np.float64(0.33976862924846435), 'benchmark': {'return_pct': np.float64(20.284536286290315), 'cagr': np.float64(0.43984068388293496), 'final_value': np.float64(212845.36286290316)}, 'alpha': np.float64(-0.4333727204417659), 'avg_atr': 623.2955836989505, 'avg_adx': 28.24622105493285, 'regime_performance': {'Unknown': {'count': 3, 'wins': 1, 'losses': 2, 'pnl': np.float64(-1504.4748121387486), 'win_rate': 33.33333333333333}, 'Bear': {'count': 110, 'wins': 67, 'losses': 43, 'pnl': np.float64(5478.716833306751), 'win_rate': 60.909090909090914}, 'Bull': {'count': 22, 'wins': 11, 'losses': 11, 'pnl': np.float64(-3418.8865168888683), 'win_rate': 50.0}}, 'criteria_result': {'status': 'NO-GO', 'reasons': ['Sharpe Ratio muito baixo: 0.02 < 0.8', 'CAGR não supera Buy & Hold: 0.6% ≤ 44.0%', 'Calmar Ratio baixo: 0.01 < 1.0', 'Profit Factor baixo: 1.01 < 1.3'], 'warnings': []}, 'strategy': 'rsi', 'timeframe': '4h'}
 DEBUG: full_params after assignment: {'length': 15, 'overbought': 70, 'oversold': 30, 'timeframe': '4h', 'stop_loss': 0.115}
 DEBUG: result_data has 135 trades
 DEBUG: First trade sample: {'entry_time': '2017-09-04T16:00:00.000000000', 'exit_time': '2017-09-05T00:00:00.000000000', 'side': 'long', 'reason': 'SL', 'entry_price': np.float64(4205.771835), 'exit_price': np.float64(3720.2470199380123), 'size': np.float64(2.3515564510193863), 'pnl_gross': np.float64(-1141.7390109890107), 'pnl': np.float64(-1160.3774917582414), 'pnl_pct': np.float64(-0.11544249999999996), 'commission': np.float64(18.638480769230767), 'initial_capital': 10000, 'final_capital': np.float64(8839.622508241759)}
 DEBUG: Result 23 keys: ['stop_loss', 'metrics', 'trades', 'test_num', 'total_tests']
 DEBUG: Result 23 has parameter 'stop_loss': True
 DEBUG: Extracted param_value for 'stop_loss': 0.12 (type: float)
 DEBUG: Result Metrics: {'total_return_pct': np.float64(0.5186912943850291), 'total_pnl_pct': np.float64(0.5186912943850291), 'total_pnl': np.float64(5186.912943850291), 'max_drawdown_pct': np.float64(-0.7341361827876259), 'max_drawdown': np.float64(-0.7341361827876259), 'cagr': np.float64(0.05110608433263231), 'num_trades': 132, 'total_trades': 132, 'win_rate': 0.6060606060606061, 'profit_factor': np.float64(1.1138770793702357), 'avg_trade_return': np.float64(39.294795029168874), 'sharpe': np.float64(0.17610111214198565), 'sharpe_ratio': np.float64(0.17610111214198565), 'final_equity': np.float64(15186.912943850291), 'duration_days': 3062, 'monthly_return_avg': np.float64(0.01231566686623745), 'avg_drawdown': np.float64(0.35826281572200364), 'max_dd_duration_days': 2173, 'recovery_factor': np.float64(-0.7065328021505218), 'sortino_ratio': np.float64(1.7596665422564026), 'calmar_ratio': np.float64(0.06961390206729055), 'expectancy': np.float64(39.29479502916894), 'max_consecutive_wins': 13, 'max_consecutive_losses': 4, 'trade_concentration_top_10_pct': np.float64(0.31722983940973515), 'benchmark': {'return_pct': np.float64(20.284536286290315), 'cagr': np.float64(0.43984068388293496), 'final_value': np.float64(212845.36286290316)}, 'alpha': np.float64(-0.38873459955030265), 'avg_atr': 623.2955836989505, 'avg_adx': 28.24622105493285, 'regime_performance': {'Unknown': {'count': 3, 'wins': 1, 'losses': 2, 'pnl': np.float64(-1599.1184178672875), 'win_rate': 33.33333333333333}, 'Bear': {'count': 107, 'wins': 67, 'losses': 40, 'pnl': np.float64(9533.887863884609), 'win_rate': 62.616822429906534}, 'Bull': {'count': 22, 'wins': 12, 'losses': 10, 'pnl': np.float64(-2747.856502167033), 'win_rate': 54.54545454545454}}, 'criteria_result': {'status': 'NO-GO', 'reasons': ['Sharpe Ratio muito baixo: 0.18 < 0.8', 'CAGR não supera Buy & Hold: 5.1% ≤ 44.0%', 'Calmar Ratio baixo: 0.07 < 1.0', 'Profit Factor baixo: 1.11 < 1.3'], 'warnings': []}, 'strategy': 'rsi', 'timeframe': '4h'}
 DEBUG: full_params after assignment: {'length': 15, 'overbought': 70, 'oversold': 30, 'timeframe': '4h', 'stop_loss': 0.12}
 DEBUG: result_data has 132 trades
 DEBUG: First trade sample: {'entry_time': '2017-09-04T16:00:00.000000000', 'exit_time': '2017-09-05T00:00:00.000000000', 'side': 'long', 'reason': 'SL', 'entry_price': np.float64(4205.771835), 'exit_price': np.float64(3699.2286751926), 'size': np.float64(2.3515564510193863), 'pnl_gross': np.float64(-1191.1648351648346), 'pnl': np.float64(-1209.7538901098894), 'pnl_pct': np.float64(-0.12043999999999994), 'commission': np.float64(18.589054945054947), 'initial_capital': 10000, 'final_capital': np.float64(8790.246109890111)}
 DEBUG: Result 24 keys: ['stop_loss', 'metrics', 'trades', 'test_num', 'total_tests']
 DEBUG: Result 24 has parameter 'stop_loss': True
 DEBUG: Extracted param_value for 'stop_loss': 0.125 (type: float)
 DEBUG: Result Metrics: {'total_return_pct': np.float64(0.24619478268642087), 'total_pnl_pct': np.float64(0.24619478268642087), 'total_pnl': np.float64(2461.9478268642088), 'max_drawdown_pct': np.float64(-0.7637971726063869), 'max_drawdown': np.float64(-0.7637971726063869), 'cagr': np.float64(0.026601623165191546), 'num_trades': 130, 'total_trades': 130, 'win_rate': 0.6153846153846154, 'profit_factor': np.float64(1.0632846296180702), 'avg_trade_return': np.float64(18.938060206647627), 'sharpe': np.float64(0.09769989728030591), 'sharpe_ratio': np.float64(0.09769989728030591), 'final_equity': np.float64(12461.947826864209), 'duration_days': 3062, 'monthly_return_avg': np.float64(0.010722653766989899), 'avg_drawdown': np.float64(0.415524820211942), 'max_dd_duration_days': 2299, 'recovery_factor': np.float64(-0.3223300524225613), 'sortino_ratio': np.float64(1.4608244286058518), 'calmar_ratio': np.float64(0.034828124689720935), 'expectancy': np.float64(18.938060206647606), 'max_consecutive_wins': 13, 'max_consecutive_losses': 4, 'trade_concentration_top_10_pct': np.float64(0.33541827686201053), 'benchmark': {'return_pct': np.float64(20.284536286290315), 'cagr': np.float64(0.43984068388293496), 'final_value': np.float64(212845.36286290316)}, 'alpha': np.float64(-0.4132390607177434), 'avg_atr': 623.2955836989505, 'avg_adx': 28.24622105493285, 'regime_performance': {'Unknown': {'count': 3, 'wins': 1, 'losses': 2, 'pnl': np.float64(-1693.2318823362264), 'win_rate': 33.33333333333333}, 'Bear': {'count': 105, 'wins': 67, 'losses': 38, 'pnl': np.float64(7294.298584553319), 'win_rate': 63.8095238095238}, 'Bull': {'count': 22, 'wins': 12, 'losses': 10, 'pnl': np.float64(-3139.1188753529013), 'win_rate': 54.54545454545454}}, 'criteria_result': {'status': 'NO-GO', 'reasons': ['Sharpe Ratio muito baixo: 0.10 < 0.8', 'CAGR não supera Buy & Hold: 2.7% ≤ 44.0%', 'Calmar Ratio baixo: 0.03 < 1.0', 'Profit Factor baixo: 1.06 < 1.3'], 'warnings': []}, 'strategy': 'rsi', 'timeframe': '4h'}
 DEBUG: full_params after assignment: {'length': 15, 'overbought': 70, 'oversold': 30, 'timeframe': '4h', 'stop_loss': 0.125}
 DEBUG: result_data has 130 trades
 DEBUG: First trade sample: {'entry_time': '2017-09-04T16:00:00.000000000', 'exit_time': '2017-09-05T00:00:00.000000000', 'side': 'long', 'reason': 'SL', 'entry_price': np.float64(4205.771835), 'exit_price': np.float64(3678.2103304471875), 'size': np.float64(2.3515564510193863), 'pnl_gross': np.float64(-1240.5906593406585), 'pnl': np.float64(-1259.1302884615377), 'pnl_pct': np.float64(-0.1254374999999999), 'commission': np.float64(18.539629120879123), 'initial_capital': 10000, 'final_capital': np.float64(8740.869711538464)}
 DEBUG: Result 25 keys: ['stop_loss', 'metrics', 'trades', 'test_num', 'total_tests']
 DEBUG: Result 25 has parameter 'stop_loss': True
 DEBUG: Extracted param_value for 'stop_loss': 0.13 (type: float)
 DEBUG: Result Metrics: {'total_return_pct': np.float64(0.29290180015608785), 'total_pnl_pct': np.float64(0.29290180015608785), 'total_pnl': np.float64(2929.0180015608785), 'max_drawdown_pct': np.float64(-0.7720148585968979), 'max_drawdown': np.float64(-0.7720148585968979), 'cagr': np.float64(0.031117294228633297), 'num_trades': 126, 'total_trades': 126, 'win_rate': 0.626984126984127, 'profit_factor': np.float64(1.0774462016984658), 'avg_trade_return': np.float64(23.246174615562527), 'sharpe': np.float64(0.11515752095792145), 'sharpe_ratio': np.float64(0.11515752095792145), 'final_equity': np.float64(12929.018001560878), 'duration_days': 3062, 'monthly_return_avg': np.float64(0.011093374837172593), 'avg_drawdown': np.float64(0.40881799678645664), 'max_dd_duration_days': 2286, 'recovery_factor': np.float64(-0.37939917463301637), 'sortino_ratio': np.float64(1.495581262319345), 'calmar_ratio': np.float64(0.04030660016723975), 'expectancy': np.float64(23.246174615562552), 'max_consecutive_wins': 13, 'max_consecutive_losses': 4, 'trade_concentration_top_10_pct': np.float64(0.33653471563122567), 'benchmark': {'return_pct': np.float64(20.284536286290315), 'cagr': np.float64(0.43984068388293496), 'final_value': np.float64(212845.36286290316)}, 'alpha': np.float64(-0.40872338965430166), 'avg_atr': 623.2955836989505, 'avg_adx': 28.24622105493285, 'regime_performance': {'Unknown': {'count': 3, 'wins': 1, 'losses': 2, 'pnl': np.float64(-1786.8152055455698), 'win_rate': 33.33333333333333}, 'Bear': {'count': 101, 'wins': 66, 'losses': 35, 'pnl': np.float64(8445.705568903935), 'win_rate': 65.34653465346535}, 'Bull': {'count': 22, 'wins': 12, 'losses': 10, 'pnl': np.float64(-3729.8723617974847), 'win_rate': 54.54545454545454}}, 'criteria_result': {'status': 'NO-GO', 'reasons': ['Sharpe Ratio muito baixo: 0.12 < 0.8', 'CAGR não supera Buy & Hold: 3.1% ≤ 44.0%', 'Calmar Ratio baixo: 0.04 < 1.0', 'Profit Factor baixo: 1.08 < 1.3'], 'warnings': []}, 'strategy': 'rsi', 'timeframe': '4h'}
 DEBUG: full_params after assignment: {'length': 15, 'overbought': 70, 'oversold': 30, 'timeframe': '4h', 'stop_loss': 0.13}
 DEBUG: result_data has 126 trades
 DEBUG: First trade sample: {'entry_time': '2017-09-04T16:00:00.000000000', 'exit_time': '2017-09-05T00:00:00.000000000', 'side': 'long', 'reason': 'SL', 'entry_price': np.float64(4205.771835), 'exit_price': np.float64(3657.1919857017747), 'size': np.float64(2.3515564510193863), 'pnl_gross': np.float64(-1290.0164835164835), 'pnl': np.float64(-1308.506686813187), 'pnl_pct': np.float64(-0.130435), 'commission': np.float64(18.4902032967033), 'initial_capital': 10000, 'final_capital': np.float64(8691.493313186813)}
2026-01-07 00:50:41,296 - app.services.job_manager - INFO - Saved batch of 26 results for job 7e1e6721-5b0c-4bc7-af81-bfaa48639eda
 Saved 26 results to database (total: 26)
 Running stage 2/2: Stop Gain
 Locked params before stage: {'timeframe': '4h', 'stop_loss': 0.12}
2026-01-07 00:50:41,330 - src.data.incremental_loader - INFO - Local cache found for BTC/USDT 1d: data/storage\binance\BTC_USDT_1d.parquet
2026-01-07 00:50:41,336 - src.data.incremental_loader - INFO - Incremental update needed. Downloading from 2026-01-06 21:00:00.001000
2026-01-07 00:50:41,339 - src.data.incremental_loader - INFO - Starting download loop for BTC/USDT from 2026-01-06 21:00:00.001000
2026-01-07 00:50:46,833 - root - INFO - Full history period: 2017-08-17T00:00:00+00:00 to 2026-01-07T00:00:00+00:00 (3066 candles)
2026-01-07 00:50:46,871 - root - INFO - Running backtest: BTC/USDT 4h from 2017-08-17 to 2026-01-07
2026-01-07 00:50:46,873 - src.data.incremental_loader - INFO - Local cache found for BTC/USDT 4h: data/storage\binance\BTC_USDT_4h.parquet
2026-01-07 00:50:46,878 - src.data.incremental_loader - INFO - Local data covers request. No network fetch needed.
2026-01-07 00:50:46,901 - app.strategies.dynamic_strategy - INFO - Processed crossover entry for RSI_14 > 30.0: 279 signals
2026-01-07 00:50:46,902 - app.strategies.dynamic_strategy - INFO - Processed crossunder exit for RSI_14 < 70.0: 339 signals
2026-01-07 00:50:46,906 - app.strategies.dynamic_strategy - INFO - Processed crossover entry for RSI_14 > 30.0: 279 signals
2026-01-07 00:50:46,907 - app.strategies.dynamic_strategy - INFO - Processed crossunder exit for RSI_14 < 70.0: 339 signals
2026-01-07 00:50:47,020 - root - INFO - DEBUG: Test 1 (stop_gain=None) -> Return: 0.5186912943850291, Equity: 15186.912943850291, PnL: 5186.912943850291
 DEBUG: stage_result keys: dict_keys(['stage_num', 'stage_name', 'parameter', 'results', 'best_value', 'best_result'])
 DEBUG: stage['parameter']: stop_gain
 DEBUG: Number of results: 1
 DEBUG: Result 0 keys: ['stop_gain', 'metrics', 'trades', 'test_num', 'total_tests']
 DEBUG: Result 0 has parameter 'stop_gain': True
 DEBUG: Extracted param_value for 'stop_gain': None (type: NoneType)
 DEBUG: Result Metrics: {'total_return_pct': np.float64(0.5186912943850291), 'total_pnl_pct': np.float64(0.5186912943850291), 'total_pnl': np.float64(5186.912943850291), 'max_drawdown_pct': np.float64(-0.7341361827876259), 'max_drawdown': np.float64(-0.7341361827876259), 'cagr': np.float64(0.05110608433263231), 'num_trades': 132, 'total_trades': 132, 'win_rate': 0.6060606060606061, 'profit_factor': np.float64(1.1138770793702357), 'avg_trade_return': np.float64(39.294795029168874), 'sharpe': np.float64(0.17610111214198565), 'sharpe_ratio': np.float64(0.17610111214198565), 'final_equity': np.float64(15186.912943850291), 'duration_days': 3062, 'monthly_return_avg': np.float64(0.01231566686623745), 'avg_drawdown': np.float64(0.35826281572200364), 'max_dd_duration_days': 2173, 'recovery_factor': np.float64(-0.7065328021505218), 'sortino_ratio': np.float64(1.7596665422564026), 'calmar_ratio': np.float64(0.06961390206729055), 'expectancy': np.float64(39.29479502916894), 'max_consecutive_wins': 13, 'max_consecutive_losses': 4, 'trade_concentration_top_10_pct': np.float64(0.31722983940973515), 'benchmark': {'return_pct': np.float64(20.284536286290315), 'cagr': np.float64(0.43984068388293496), 'final_value': np.float64(212845.36286290316)}, 'alpha': np.float64(-0.38873459955030265), 'avg_atr': 623.2955836989505, 'avg_adx': 28.24622105493285, 'regime_performance': {'Unknown': {'count': 3, 'wins': 1, 'losses': 2, 'pnl': np.float64(-1599.1184178672875), 'win_rate': 33.33333333333333}, 'Bear': {'count': 107, 'wins': 67, 'losses': 40, 'pnl': np.float64(9533.887863884609), 'win_rate': 62.616822429906534}, 'Bull': {'count': 22, 'wins': 12, 'losses': 10, 'pnl': np.float64(-2747.856502167033), 'win_rate': 54.54545454545454}}, 'criteria_result': {'status': 'NO-GO', 'reasons': ['Sharpe Ratio muito baixo: 0.18 < 0.8', 'CAGR não supera Buy & Hold: 5.1% ≤ 44.0%', 'Calmar Ratio baixo: 0.07 < 1.0', 'Profit Factor baixo: 1.11 < 1.3'], 'warnings': []}, 'strategy': 'rsi', 'timeframe': '4h'}
 DEBUG: full_params after assignment: {'length': 15, 'overbought': 70, 'oversold': 30, 'timeframe': '4h', 'stop_loss': 0.12, 'stop_gain': None}
 DEBUG: result_data has 132 trades
 DEBUG: First trade sample: {'entry_time': '2017-09-04T16:00:00.000000000', 'exit_time': '2017-09-05T00:00:00.000000000', 'side': 'long', 'reason': 'SL', 'entry_price': np.float64(4205.771835), 'exit_price': np.float64(3699.2286751926), 'size': np.float64(2.3515564510193863), 'pnl_gross': np.float64(-1191.1648351648346), 'pnl': np.float64(-1209.7538901098894), 'pnl_pct': np.float64(-0.12043999999999994), 'commission': np.float64(18.589054945054947), 'initial_capital': 10000, 'final_capital': np.float64(8790.246109890111)}
2026-01-07 00:50:47,098 - app.services.job_manager - INFO - Saved batch of 1 results for job 7e1e6721-5b0c-4bc7-af81-bfaa48639eda
 Saved 1 results to database (total: 27)
 Using best result from FINAL STAGE with all optimized params: {'length': 15, 'overbought': 70, 'oversold': 30, 'timeframe': '4h', 'stop_loss': 0.12}
 Optimization complete! Tested 27 combinations in 44.2s
 Job 7e1e6721-5b0c-4bc7-af81-bfaa48639eda completed and saved to database
 DEBUG: Best result has 132 trades
 DEBUG: Best Result Params: {'length': 15, 'overbought': 70, 'oversold': 30, 'timeframe': '4h', 'stop_loss': 0.12}
 DEBUG: Best Result First Trade: {'entry_time': '2017-09-04T16:00:00.000000000', 'exit_time': '2017-09-05T00:00:00.000000000', 'side': 'long', 'reason': 'SL', 'entry_price': np.float64(4205.771835), 'exit_price': np.float64(3699.2286751926), 'size': np.float64(2.3515564510193863), 'pnl_gross': np.float64(-1191.1648351648346), 'pnl': np.float64(-1209.7538901098894), 'pnl_pct': np.float64(-0.12043999999999994), 'commission': np.float64(18.589054945054947), 'initial_capital': 10000, 'final_capital': np.float64(8790.246109890111)}
2026-01-07 00:51:07,561 - app.main - INFO - ================================================================================
2026-01-07 00:51:07,561 - app.main - INFO - Backend starting up - logging to C:\Users\alans.triggo\OneDrive - Corpay\Documentos\projetos\crypto\backend\full_execution_log.txt
2026-01-07 00:51:07,561 - app.main - INFO - ================================================================================
