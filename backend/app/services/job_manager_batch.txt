    
    def save_results_batch(self, job_id: str, results: List[Dict], start_index: int):
        '''Save multiple optimization results in a single transaction for better performance'''
        if not results:
            return
        
        try:
            conn = sqlite3.connect(str(self.db_path))
            # Use explicit transaction
            conn.execute('BEGIN TRANSACTION')
            
            # Prepare batch data
            batch_data = []
            for i, result in enumerate(results):
                batch_data.append((
                    job_id,
                    start_index + i,
                    json.dumps(result.get('params', {})),
                    json.dumps(result.get('metrics', {}))
                ))
            
            # Execute batch insert
            conn.executemany('''
                INSERT OR REPLACE INTO optimization_results 
                (job_id, result_index, params_json, metrics_json)
                VALUES (?, ?, ?, ?)
            ''', batch_data)
            
            conn.commit()
            conn.close()
            logger.info(f'Saved batch of {len(results)} results for job {job_id}')
        except Exception as e:
            logger.error(f'Failed to save batch for job {job_id}: {e}')
            if conn:
                conn.rollback()
                conn.close()
